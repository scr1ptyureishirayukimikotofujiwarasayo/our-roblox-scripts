-- Fujiwarasayo's Admin Script (Extended)
-- By illremember#3799

local Players = game:GetService("Players")
local Workspace = game:GetService("Workspace")
local Lighting = game:GetService("Lighting")
local CoreGui = game:GetService("CoreGui")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local TweenService = game:GetService("TweenService")
local HttpService = game:GetService("HttpService")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local StarterGui = game:GetService("StarterGui")

local LP = Players.LocalPlayer
local Mouse = LP:GetMouse()

-- Settings
local prefix = ";"
local noclipEnabled = false
local flying = false
local walkSpeed = 16
local jumpPower = 50
local savedPosition = nil
local clickTpEnabled = false
local spamActive = false
local spamMessage = ""
local spamDelay = 1

-- Notification System
function notify(title, message, duration)
    local screenGui = Instance.new("ScreenGui")
    screenGui.Parent = CoreGui
    screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
    
    local frame = Instance.new("Frame")
    frame.Size = UDim2.new(0, 300, 0, 80)
    frame.Position = UDim2.new(0.5, -150, 0, 50)
    frame.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
    frame.BorderSizePixel = 0
    frame.Parent = screenGui
    
    local titleLbl = Instance.new("TextLabel")
    titleLbl.Size = UDim2.new(1, 0, 0, 20)
    titleLbl.Position = UDim2.new(0, 0, 0, 5)
    titleLbl.BackgroundTransparency = 1
    titleLbl.Text = title
    titleLbl.TextColor3 = Color3.fromRGB(255, 255, 100)
    titleLbl.TextSize = 16
    titleLbl.Font = Enum.Font.SourceSansBold
    titleLbl.Parent = frame
    
    local msgLbl = Instance.new("TextLabel")
    msgLbl.Size = UDim2.new(1, 0, 0, 40)
    msgLbl.Position = UDim2.new(0, 0, 0, 25)
    msgLbl.BackgroundTransparency = 1
    msgLbl.Text = message
    msgLbl.TextColor3 = Color3.fromRGB(230, 230, 230)
    msgLbl.TextSize = 14
    msgLbl.Font = Enum.Font.SourceSans
    msgLbl.TextWrapped = true
    msgLbl.Parent = frame
    
    local closeBtn = Instance.new("TextButton")
    closeBtn.Size = UDim2.new(0, 20, 0, 20)
    closeBtn.Position = UDim2.new(1, -25, 0, 5)
    closeBtn.Text = "X"
    closeBtn.TextColor3 = Color3.fromRGB(255, 100, 100)
    closeBtn.BackgroundTransparency = 0.5
    closeBtn.BackgroundColor3 = Color3.fromRGB(50, 50, 60)
    closeBtn.Parent = frame
    
    closeBtn.MouseButton1Click:Connect(function()
        screenGui:Destroy()
    end)
    
    spawn(function()
        wait(duration or 5)
        if screenGui and screenGui.Parent then
            screenGui:Destroy()
        end
    end)
end

-- Utility Functions
function findPlayer(name)
    for _, player in pairs(Players:GetPlayers()) do
        if string.sub(string.lower(player.Name), 1, #name) == string.lower(name) then
            return player
        end
    end
    return nil
end

function hasTools()
    for _, child in pairs(LP.Character:GetDescendants()) do
        if child:IsA("Tool") then
            return true
        end
    end
    for _, child in pairs(LP.Backpack:GetDescendants()) do
        if child:IsA("Tool") then
            return true
        end
    end
    return false
end

-- Core Commands
local commands = {}

commands.help = function()
    local helpText = "Available Commands:\n"
    for cmdName, _ in pairs(commands) do
        helpText = helpText .. prefix .. cmdName .. "\n"
    end
    notify("Help", helpText, 10)
end

commands.prefix = function(args)
    if args[1] then
        prefix = args[1]:sub(1, 1)
        notify("Prefix Changed", "New prefix: " .. prefix, 3)
    end
end

commands.noclip = function()
    noclipEnabled = true
    notify("Noclip", "Enabled", 3)
end

commands.clip = function()
    noclipEnabled = false
    notify("Noclip", "Disabled", 3)
end

commands.speed = function(args)
    if args[1] and tonumber(args[1]) then
        LP.Character.Humanoid.WalkSpeed = tonumber(args[1])
        notify("Walk Speed", "Set to " .. args[1], 3)
    end
end

commands.jp = function(args)
    if args[1] and tonumber(args[1]) then
        LP.Character.Humanoid.JumpPower = tonumber(args[1])
        notify("Jump Power", "Set to " .. args[1], 3)
    end
end

commands.sit = function()
    LP.Character.Humanoid.Sit = true
    notify("Sit", "Activated", 3)
end

commands.reset = function()
    LP.Character:BreakJoints()
    notify("Reset", "Character reset", 3)
end

commands.god = function()
    local humanoid = LP.Character.Humanoid
    humanoid.Name = "1"
    local newHum = humanoid:Clone()
    newHum.Parent = LP.Character
    newHum.Name = "Humanoid"
    wait()
    humanoid:Destroy()
    Workspace.CurrentCamera.CameraSubject = LP.Character
    LP.Character.Animate:Destroy()
    notify("God Mode", "Activated (tools broken)", 5)
end

commands.goto = function(args)
    if args[1] then
        local player = findPlayer(args[1])
        if player and player.Character then
            LP.Character:SetPrimaryPartCFrame(player.Character:GetPrimaryPartCFrame())
            notify("Teleport", "Teleported to " .. player.Name, 3)
        end
    end
end

commands.btools = function()
    local cloneBin = Instance.new("HopperBin")
    cloneBin.BinType = Enum.BinType.Clone
    cloneBin.Parent = LP:FindFirstChildOfClass("Backpack")
    
    local hammerBin = Instance.new("HopperBin")
    hammerBin.BinType = Enum.BinType.Hammer
    hammerBin.Parent = LP:FindFirstChildOfClass("Backpack")
    
    local grabBin = Instance.new("HopperBin")
    grabBin.BinType = Enum.BinType.Grab
    grabBin.Parent = LP:FindFirstChildOfClass("Backpack")
    
    notify("BTools", "Added to backpack", 3)
end

commands.invisible = function()
    local character = LP.Character
    if character:FindFirstChild("HumanoidRootPart") then
        local root = character.HumanoidRootPart
        local clone = root:Clone()
        root:Destroy()
        clone.Parent = character
        notify("Invisible", "Activated", 3)
    end
end

commands.fly = function(args)
    local speed = tonumber(args[1]) or 50
    local chr = LP.Character
    local hum = chr and chr:FindFirstChildOfClass("Humanoid")
    local rootPart = chr and chr:FindFirstChild("HumanoidRootPart")
    
    if not (chr and hum and rootPart) then return end
    
    flying = true
    local bodyGyro = Instance.new("BodyGyro")
    bodyGyro.P = 9e4
    bodyGyro.maxTorque = Vector3.new(9e9, 9e9, 9e9)
    bodyGyro.cframe = rootPart.CFrame
    bodyGyro.Parent = rootPart
    
    local bodyVelocity = Instance.new("BodyVelocity")
    bodyVelocity.velocity = Vector3.new(0, 0.1, 0)
    bodyVelocity.maxForce = Vector3.new(9e9, 9e9, 9e9)
    bodyVelocity.Parent = rootPart
    
    hum.PlatformStand = true
    
    local controls = {F = 0, B = 0, L = 0, R = 0}
    
    local function updateFlight()
        repeat
            RunService.RenderStepped:Wait()
            
            local camCF = Workspace.CurrentCamera.CFrame
            local moveVector = Vector3.new(
                controls.R - controls.L,
                0,
                controls.B - controls.F
            )
            
            if moveVector.Magnitude > 0 then
                local lookVector = camCF.LookVector
                local rightVector = camCF.RightVector
                local moveDir = (lookVector * -moveVector.Z) + (rightVector * moveVector.X)
                bodyVelocity.velocity = moveDir.Unit * speed
            else
                bodyVelocity.velocity = Vector3.new(0, 0.1, 0)
            end
            
            bodyGyro.cframe = camCF
        until not flying
        
        bodyGyro:Destroy()
        bodyVelocity:Destroy()
        hum.PlatformStand = false
    end
    
    spawn(updateFlight)
    
    local function onKeyDown(key)
        key = key:lower()
        if key == "w" then controls.F = 1
        elseif key == "s" then controls.B = 1
        elseif key == "a" then controls.L = 1
        elseif key == "d" then controls.R = 1
        end
    end
    
    local function onKeyUp(key)
        key = key:lower()
        if key == "w" then controls.F = 0
        elseif key == "s" then controls.B = 0
        elseif key == "a" then controls.L = 0
        elseif key == "d" then controls.R = 0
        end
    end
    
    local keyConn1 = Mouse.KeyDown:Connect(onKeyDown)
    local keyConn2 = Mouse.KeyUp:Connect(onKeyUp)
    
    spawn(function()
        repeat wait() until not flying
        keyConn1:Disconnect()
        keyConn2:Disconnect()
    end)
    
    notify("Fly", "Activated (WASD to move)", 5)
end

commands.unfly = function()
    flying = false
    notify("Fly", "Deactivated", 3)
end

commands.esp = function(args)
    if args[1] then
        local player = findPlayer(args[1])
        if player and player.Character then
            for _, part in pairs(player.Character:GetDescendants()) do
                if part:IsA("BasePart") and part.Name ~= "HumanoidRootPart" then
                    local box = Instance.new("BoxHandleAdornment")
                    box.Adornee = part
                    box.AlwaysOnTop = true
                    box.Color3 = Color3.new(1, 0, 0)
                    box.Size = part.Size
                    box.ZIndex = 10
                    box.Transparency = 0.5
                    box.Parent = CoreGui
                    
                    -- Clean up when player leaves
                    player.CharacterRemoving:Connect(function()
                        box:Destroy()
                    end)
                end
            end
            notify("ESP", "Enabled for " .. player.Name, 3)
        end
    end
end

commands.unesp = function()
    for _, obj in pairs(CoreGui:GetChildren()) do
        if obj:IsA("BoxHandleAdornment") then
            obj:Destroy()
        end
    end
    notify("ESP", "Disabled", 3)
end

commands.removefog = function()
    Lighting.FogEnd = 100000
    notify("Fog", "Removed", 3)
end

commands.wsvis = function(args)
    if args[1] and tonumber(args[1]) then
        local transparency = math.clamp(tonumber(args[1]), 0, 1)
        for _, part in pairs(Workspace:GetDescendants()) do
            if part:IsA("BasePart") then
                part.Transparency = transparency
            end
        end
        notify("Workspace Visibility", "Transparency set to " .. transparency, 3)
    end
end

commands.chat = function(args)
    if #args > 0 then
        local message = table.concat(args, " ")
        ReplicatedStorage.DefaultChatSystemChatEvents.SayMessageRequest:FireServer(message, "All")
    end
end

commands.ping = function()
    local ping = LP:GetNetworkPing() * 1000
    notify("Ping", math.round(ping) .. "ms", 3)
end

-- Additional Useful Commands

commands.freeze = function(args)
    if args[1] then
        local player = findPlayer(args[1])
        if player and player.Character then
            player.Character.HumanoidRootPart.Anchored = true
            notify("Freeze", "Frozen " .. player.Name, 3)
        end
    else
        LP.Character.HumanoidRootPart.Anchored = true
        notify("Freeze", "Frozen yourself", 3)
    end
end

commands.thaw = function(args)
    if args[1] then
        local player = findPlayer(args[1])
        if player and player.Character then
            player.Character.HumanoidRootPart.Anchored = false
            notify("Thaw", "Unfrozen " .. player.Name, 3)
        end
    else
        LP.Character.HumanoidRootPart.Anchored = false
        notify("Thaw", "Unfrozen yourself", 3)
    end
end

commands.savepos = function()
    savedPosition = LP.Character:GetPrimaryPartCFrame()
    notify("Position", "Position saved", 3)
end

commands.loadpos = function()
    if savedPosition then
        LP.Character:SetPrimaryPartCFrame(savedPosition)
        notify("Position", "Position loaded", 3)
    else
        notify("Error", "No position saved", 3)
    end
end

commands.tppos = function(args)
    if #args >= 3 then
        local x, y, z = tonumber(args[1]), tonumber(args[2]), tonumber(args[3])
        if x and y and z then
            LP.Character:SetPrimaryPartCFrame(CFrame.new(x, y, z))
            notify("Teleport", "Teleported to " .. x .. ", " .. y .. ", " .. z, 3)
        end
    end
end

commands.clicktp = function()
    clickTpEnabled = true
    notify("Click TP", "Enabled - Click anywhere to teleport", 5)
    
    local clickConn
    clickConn = Mouse.Button1Down:Connect(function()
        if clickTpEnabled and Mouse.Target then
            LP.Character:SetPrimaryPartCFrame(CFrame.new(Mouse.Hit.Position + Vector3.new(0, 5, 0)))
        end
    end)
    
    -- Store connection for cleanup
    commands._clickTpConn = clickConn
end

commands.unclicktp = function()
    clickTpEnabled = false
    if commands._clickTpConn then
        commands._clickTpConn:Disconnect()
        commands._clickTpConn = nil
    end
    notify("Click TP", "Disabled", 3)
end

commands.gravity = function(args)
    if args[1] and tonumber(args[1]) then
        Workspace.Gravity = tonumber(args[1])
        notify("Gravity", "Set to " .. args[1], 3)
    end
end

commands.ungravity = function()
    Workspace.Gravity = 196.2
    notify("Gravity", "Reset to default", 3)
end

commands.btools = function()
    local tools = {"Clone", "Hammer", "Grab"}
    for _, toolType in pairs(tools) do
        local bin = Instance.new("HopperBin")
        bin.BinType = Enum.BinType[toolType]
        bin.Parent = LP:FindFirstChildOfClass("Backpack")
    end
    notify("BTools", "Added all building tools", 3)
end

commands.nametags = function()
    for _, player in pairs(Players:GetPlayers()) do
        if player ~= LP and player.Character and player.Character:FindFirstChild("Head") then
            local billboard = Instance.new("BillboardGui")
            billboard.Name = "NameTag"
            billboard.Adornee = player.Character.Head
            billboard.Size = UDim2.new(0, 100, 0, 50)
            billboard.StudsOffset = Vector3.new(0, 3, 0)
            billboard.AlwaysOnTop = true
            
            local textLabel = Instance.new("TextLabel")
            textLabel.Size = UDim2.new(1, 0, 1, 0)
            textLabel.BackgroundTransparency = 1
            textLabel.Text = player.Name
            textLabel.TextColor3 = Color3.new(1, 1, 1)
            textLabel.TextStrokeTransparency = 0
            textLabel.Font = Enum.Font.SourceSansBold
            textLabel.TextSize = 20
            textLabel.Parent = billboard
            
            billboard.Parent = CoreGui
        end
    end
    notify("Nametags", "Enabled for all players", 3)
end

commands.unnametags = function()
    for _, obj in pairs(CoreGui:GetChildren()) do
        if obj.Name == "NameTag" then
            obj:Destroy()
        end
    end
    notify("Nametags", "Disabled", 3)
end

commands.age = function(args)
    if args[1] then
        local player = findPlayer(args[1])
        if player then
            notify("Account Age", player.Name .. " is " .. player.AccountAge .. " days old", 5)
        end
    else
        notify("Account Age", "You are " .. LP.AccountAge .. " days old", 5)
    end
end

commands.id = function(args)
    if args[1] then
        local player = findPlayer(args[1])
        if player then
            notify("User ID", player.Name .. "'s ID: " .. player.UserId, 5)
        end
    else
        notify("User ID", "Your ID: " .. LP.UserId, 5)
    end
end

commands.allage = function()
    local ages = {}
    for _, player in pairs(Players:GetPlayers()) do
        table.insert(ages, player.Name .. ": " .. player.AccountAge .. " days")
    end
    notify("All Ages", table.concat(ages, "\n"), 10)
end

commands.allid = function()
    local ids = {}
    for _, player in pairs(Players:GetPlayers()) do
        table.insert(ids, player.Name .. ": " .. player.UserId)
    end
    notify("All IDs", table.concat(ids, "\n"), 10)
end

commands.spam = function(args)
    if #args > 0 then
        local message = table.concat(args, " ")
        for i = 1, 5 do
            ReplicatedStorage.DefaultChatSystemChatEvents.SayMessageRequest:FireServer(message, "All")
            wait(0.5)
        end
        notify("Spam", "Sent 5 messages", 3)
    end
end

commands.clear = function()
    for _, part in pairs(Workspace:GetDescendants()) do
        if part:IsA("BasePart") and part.Name ~= "HumanoidRootPart" then
            part:Destroy()
        end
    end
    notify("Clear", "Removed all parts (except characters)", 5)
end

commands.btoolsremove = function()
    for _, tool in pairs(LP:FindFirstChildOfClass("Backpack"):GetChildren()) do
        if tool:IsA("HopperBin") then
            tool:Destroy()
        end
    end
    notify("BTools Remove", "Removed all building tools", 3)
end

commands.maxzoom = function(args)
    if args[1] and tonumber(args[1]) then
        LP.CameraMaxZoomDistance = tonumber(args[1])
        notify("Max Zoom", "Set to " .. args[1], 3)
    end
end

commands.minzoom = function(args)
    if args[1] and tonumber(args[1]) then
        LP.CameraMinZoomDistance = tonumber(args[1])
        notify("Min Zoom", "Set to " .. args[1], 3)
    end
end

commands.fieldofview = function(args)
    if args[1] and tonumber(args[1]) then
        Workspace.CurrentCamera.FieldOfView = math.clamp(tonumber(args[1]), 1, 120)
        notify("FOV", "Set to " .. args[1], 3)
    end
end

commands.fullbright = function()
    Lighting.ClockTime = 12
    Lighting.FogEnd = 100000
    Lighting.Brightness = 2
    notify("Full Bright", "Enabled", 3)
end

commands.normalbright = function()
    Lighting.ClockTime = 12
    Lighting.FogEnd = 10000
    Lighting.Brightness = 1
    notify("Normal Bright", "Enabled", 3)
end

commands.day = function()
    Lighting.ClockTime = 12
    notify("Time", "Set to daytime", 3)
end

commands.night = function()
    Lighting.ClockTime = 0
    notify("Time", "Set to nighttime", 3)
end

commands.view = function(args)
    if args[1] then
        local player = findPlayer(args[1])
        if player and player.Character then
            Workspace.CurrentCamera.CameraSubject = player.Character
            notify("View", "Now viewing " .. player.Name, 3)
        end
    else
        Workspace.CurrentCamera.CameraSubject = LP.Character
        notify("View", "Now viewing yourself", 3)
    end
end

commands.unview = function()
    Workspace.CurrentCamera.CameraSubject = LP.Character
    notify("View", "Stopped viewing", 3)
end

commands.droptools = function()
    for _, tool in pairs(LP.Character:GetDescendants()) do
        if tool:IsA("Tool") then
            tool.Parent = Workspace
        end
    end
    for _, tool in pairs(LP.Backpack:GetDescendants()) do
        if tool:IsA("Tool") then
            tool.Parent = Workspace
        end
    end
    notify("Drop Tools", "Dropped all tools", 3)
end

commands.gettools = function()
    for _, obj in pairs(Workspace:GetDescendants()) do
        if obj:IsA("Tool") then
            obj.Parent = LP.Backpack
        end
    end
    notify("Get Tools", "Collected all tools", 3)
end

commands.nolimbs = function()
    local char = LP.Character
    if char then
        for _, limb in pairs({"Left Arm", "Right Arm", "Left Leg", "Right Leg"}) do
            local part = char:FindFirstChild(limb)
            if part then
                part:Destroy()
            end
        end
        notify("No Limbs", "Removed limbs", 3)
    end
end

commands.headless = function()
    local char = LP.Character
    if char and char:FindFirstChild("Head") then
        char.Head:Destroy()
        notify("Headless", "Removed head", 3)
    end
end

-- 20 Additional Commands

commands.spy = function()
    for _, player in pairs(Players:GetPlayers()) do
        player.Chatted:Connect(function(message)
            notify("Spy [" .. player.Name .. "]", message, 3)
        end)
    end
    notify("Chat Spy", "Listening to all chat", 5)
end

commands.unspy = function()
    -- This would require storing connections to disconnect them
    notify("Chat Spy", "Stopped spying (restart script to fully disable)", 3)
end

commands.dice = function()
    local roll = math.random(1, 6)
    ReplicatedStorage.DefaultChatSystemChatEvents.SayMessageRequest:FireServer("Rolled a " .. roll, "All")
    notify("Dice Roll", "You rolled: " .. roll, 3)
end

commands.flipcoin = function()
    local result = math.random(1, 2) == 1 and "Heads" or "Tails"
    ReplicatedStorage.DefaultChatSystemChatEvents.SayMessageRequest:FireServer("Flipped coin: " .. result, "All")
    notify("Coin Flip", "Result: " .. result, 3)
end

commands.serverinfo = function()
    local info = "Server Time: " .. math.floor(Workspace.DistributedGameTime) .. "s\n"
    info = info .. "Players: " .. #Players:GetPlayers() .. "/" .. Players.MaxPlayers .. "\n"
    info = info .. "Place ID: " .. game.PlaceId .. "\n"
    info = info .. "Job ID: " .. game.JobId:sub(1, 8) .. "..."
    notify("Server Info", info, 8)
end

commands.playerlist = function()
    local players = {}
    for _, player in pairs(Players:GetPlayers()) do
        table.insert(players, player.Name)
    end
    notify("Players (" .. #players .. ")", table.concat(players, ", "), 8)
end

commands.bring = function(args)
    if args[1] then
        local player = findPlayer(args[1])
        if player and player.Character then
            player.Character:SetPrimaryPartCFrame(LP.Character:GetPrimaryPartCFrame() + Vector3.new(0, 0, 3))
            notify("Bring", "Brought " .. player.Name, 3)
        end
    end
end

commands.kill = function(args)
    if args[1] then
        local player = findPlayer(args[1])
        if player and player.Character then
            player.Character:BreakJoints()
            notify("Kill", "Killed " .. player.Name, 3)
        end
    end
end

commands.kick = function(args)
    if args[1] then
        local player = findPlayer(args[1])
        if player then
            ReplicatedStorage.DefaultChatSystemChatEvents.SayMessageRequest:FireServer("/kick " .. player.Name, "All")
            notify("Kick", "Attempted to kick " .. player.Name, 3)
        end
    end
end

commands.mute = function(args)
    if args[1] then
        local player = findPlayer(args[1])
        if player then
            ReplicatedStorage.DefaultChatSystemChatEvents.SayMessageRequest:FireServer("/mute " .. player.Name, "All")
            notify("Mute", "Attempted to mute " .. player.Name, 3)
        end
    end
end

commands.unmute = function(args)
    if args[1] then
        local player = findPlayer(args[1])
        if player then
            ReplicatedStorage.DefaultChatSystemChatEvents.SayMessageRequest:FireServer("/unmute " .. player.Name, "All")
            notify("Unmute", "Attempted to unmute " .. player.Name, 3)
        end
    end
end

commands.loopgoto = function(args)
    if args[1] then
        local player = findPlayer(args[1])
        if player and player.Character then
            commands._loopGotoRunning = true
            spawn(function()
                while commands._loopGotoRunning and player and player.Character do
                    LP.Character:SetPrimaryPartCFrame(player.Character:GetPrimaryPartCFrame() + Vector3.new(0, 3, 0))
                    wait(0.1)
                end
            end)
            notify("Loop Goto", "Following " .. player.Name, 3)
        end
    end
end

commands.unloopgoto = function()
    commands._loopGotoRunning = false
    notify("Loop Goto", "Stopped following", 3)
end

commands.platform = function()
    local platform = Instance.new("Part")
    platform.Name = "AdminPlatform"
    platform.Size = Vector3.new(10, 1, 10)
    platform.Anchored = true
    platform.BrickColor = BrickColor.new("Really blue")
    platform.Material = Enum.Material.Neon
    platform.TopSurface = Enum.SurfaceType.Smooth
    platform.Parent = Workspace
    
    local pos = LP.Character:GetPrimaryPartCFrame()
    platform.CFrame = pos + Vector3.new(0, -3, 0)
    
    notify("Platform", "Created platform below you", 3)
end

commands.removeplatform = function()
    for _, obj in pairs(Workspace:GetChildren()) do
        if obj.Name == "AdminPlatform" then
            obj:Destroy()
        end
    end
    notify("Platform", "Removed platforms", 3)
end

commands.autosit = function()
    commands._autoSitRunning = true
    spawn(function()
        while commands._autoSitRunning do
            if LP.Character and LP.Character:FindFirstChild("Humanoid") then
                LP.Character.Humanoid.Sit = true
            end
            wait(0.5)
        end
    end)
    notify("Auto Sit", "Activated", 3)
end

commands.unautosit = function()
    commands._autoSitRunning = false
    notify("Auto Sit", "Deactivated", 3)
end

commands.annoy = function(args)
    if args[1] then
        local player = findPlayer(args[1])
        if player and player.Character then
            commands._annoyRunning = true
            spawn(function()
                while commands._annoyRunning and player and player.Character do
                    LP.Character:SetPrimaryPartCFrame(player.Character:GetPrimaryPartCFrame())
                    wait(0.1)
                end
            end)
            notify("Annoy", "Annoying " .. player.Name, 3)
        end
    end
end

commands.unannoy = function()
    commands._annoyRunning = false
    notify("Annoy", "Stopped annoying", 3)
end

commands.spamstart = function(args)
    if #args > 0 then
        spamMessage = table.concat(args, " ")
        spamActive = true
        spawn(function()
            while spamActive do
                ReplicatedStorage.DefaultChatSystemChatEvents.SayMessageRequest:FireServer(spamMessage, "All")
                wait(spamDelay)
            end
        end)
        notify("Spam", "Started spamming: " .. spamMessage, 3)
    end
end

commands.spamstop = function()
    spamActive = false
    notify("Spam", "Stopped spamming", 3)
end

commands.spamdelay = function(args)
    if args[1] and tonumber(args[1]) then
        spamDelay = tonumber(args[1])
        notify("Spam Delay", "Set to " .. spamDelay .. " seconds", 3)
    end
end

commands.dance = function()
    local animation = Instance.new("Animation")
    animation.AnimationId = "rbxassetid://3119674562" -- Default dance animation
    local track = LP.Character.Humanoid:LoadAnimation(animation)
    track:Play()
    notify("Dance", "Started dancing", 3)
    
    -- Store for stopping
    commands._danceTrack = track
end

commands.undance = function()
    if commands._danceTrack then
        commands._danceTrack:Stop()
        commands._danceTrack = nil
        notify("Dance", "Stopped dancing", 3)
    end
end

commands.confuse = function()
    local animation = Instance.new("Animation")
    animation.AnimationId = "rbxassetid://3379609655" -- Confused animation
    local track = LP.Character.Humanoid:LoadAnimation(animation)
    track:Play()
    notify("Confuse", "Acting confused", 3)
    
    -- Store for stopping
    commands._confuseTrack = track
end

commands.unconfuse = function()
    if commands._confuseTrack then
        commands._confuseTrack:Stop()
        commands._confuseTrack = nil
        notify("Confuse", "Stopped being confused", 3)
    end
end

commands.salute = function()
    local animation = Instance.new("Animation")
    animation.AnimationId = "rbxassetid://3313280619" -- Salute animation
    local track = LP.Character.Humanoid:LoadAnimation(animation)
    track:Play()
    notify("Salute", "Saluting", 3)
    
    -- Store for stopping
    commands._saluteTrack = track
end

commands.unsalute = function()
    if commands._saluteTrack then
        commands._saluteTrack:Stop()
        commands._saluteTrack = nil
        notify("Salute", "Stopped saluting", 3)
    end
end

commands.wave = function()
    local animation = Instance.new("Animation")
    animation.AnimationId = "rbxassetid://3313326211" -- Wave animation
    local track = LP.Character.Humanoid:LoadAnimation(animation)
    track:Play()
    notify("Wave", "Waving", 3)
    
    -- Store for stopping
    commands._waveTrack = track
end

commands.unwave = function()
    if commands._waveTrack then
        commands._waveTrack:Stop()
        commands._waveTrack = nil
        notify("Wave", "Stopped waving", 3)
    end
end

commands.laugh = function()
    local animation = Instance.new("Animation")
    animation.AnimationId = "rbxassetid://3313403884" -- Laugh animation
    local track = LP.Character.Humanoid:LoadAnimation(animation)
    track:Play()
    notify("Laugh", "Laughing", 3)
    
    -- Store for stopping
    commands._laughTrack = track
end

commands.unlaugh = function()
    if commands._laughTrack then
        commands._laughTrack:Stop()
        commands._laughTrack = nil
        notify("Laugh", "Stopped laughing", 3)
    end
end

commands.clap = function()
    local animation = Instance.new("Animation")
    animation.AnimationId = "rbxassetid://3313391755" -- Clap animation
    local track = LP.Character.Humanoid:LoadAnimation(animation)
    track:Play()
    notify("Clap", "Clapping", 3)
    
    -- Store for stopping
    commands._clapTrack = track
end

commands.unclap = function()
    if commands._clapTrack then
        commands._clapTrack:Stop()
        commands._clapTrack = nil
        notify("Clap", "Stopped clapping", 3)
    end
end

commands.point = function()
    local animation = Instance.new("Animation")
    animation.AnimationId = "rbxassetid://3313421352" -- Point animation
    local track = LP.Character.Humanoid:LoadAnimation(animation)
    track:Play()
    notify("Point", "Pointing", 3)
    
    -- Store for stopping
    commands._pointTrack = track
end

commands.unpoint = function()
    if commands._pointTrack then
        commands._pointTrack:Stop()
        commands._pointTrack = nil
        notify("Point", "Stopped pointing", 3)
    end
end

-- Command Processor
function processCommand(message)
    if string.sub(message, 1, 1) == prefix then
        local fullCommand = string.sub(message, 2)
        local splitCommand = {}
        for word in string.gmatch(fullCommand, "%S+") do
            table.insert(splitCommand, word)
        end
        
        local commandName = string.lower(splitCommand[1] or "")
        table.remove(splitCommand, 1)
        
        local commandFunction = commands[commandName]
        if commandFunction then
            commandFunction(splitCommand)
        else
            notify("Error", "Unknown command: " .. commandName, 3)
        end
    end
end

-- Chat Connection
LP.Chatted:Connect(processCommand)

-- Noclip Loop
RunService.Stepped:Connect(function()
    if noclipEnabled and LP.Character then
        for _, part in pairs(LP.Character:GetDescendants()) do
            if part:IsA("BasePart") then
                part.CanCollide = false
            end
        end
    end
end)

-- Command Bar GUI
local commandBar = Instance.new("ScreenGui")
commandBar.Name = "FujiwarasayoCommandBar"
commandBar.Parent = CoreGui

local textBox = Instance.new("TextBox")
textBox.Size = UDim2.new(0, 200, 0, 30)
textBox.Position = UDim2.new(0, 10, 1, -40)
textBox.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
textBox.TextColor3 = Color3.fromRGB(230, 230, 230)
textBox.PlaceholderText = "Enter command..."
textBox.Text = ""
textBox.Parent = commandBar

textBox.FocusLost:Connect(function(enterPressed)
    if enterPressed and textBox.Text ~= "" then
        processCommand(prefix .. textBox.Text)
        textBox.Text = ""
    end
end)

Mouse.KeyDown:Connect(function(key)
    if key == prefix then
        textBox:CaptureFocus()
    end
end)

-- Cleanup on script termination
game:BindToClose(function()
    -- Stop any running loops
    commands._loopGotoRunning = false
    commands._autoSitRunning = false
    commands._annoyRunning = false
    spamActive = false
    
    -- Stop animations
    if commands._danceTrack then commands._danceTrack:Stop() end
    if commands._confuseTrack then commands._confuseTrack:Stop() end
    if commands._saluteTrack then commands._saluteTrack:Stop() end
    if commands._waveTrack then commands._waveTrack:Stop() end
    if commands._laughTrack then commands._laughTrack:Stop() end
    if commands._clapTrack then commands._clapTrack:Stop() end
    if commands._pointTrack then commands._pointTrack:Stop() end
end)

-- Initial Notification
notify("Fujiwarasayo Admin", "Loaded successfully!\nUse " .. prefix .. "help for commands", 5)
