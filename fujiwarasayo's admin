-- FujiwaraSayo's Admin (Client-Sided)
-- Based on Shattervast by illremember#3799
-- Enhanced with additional client-sided features

-- Services
local Players = game:GetService("Players")
local Workspace = game:GetService("Workspace")
local Lighting = game:GetService("Lighting")
local CoreGui = game:GetService("CoreGui")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local HttpService = game:GetService("HttpService")
local TeleportService = game:GetService("TeleportService")
local TextService = game:GetService("TextService")

-- Local Player
local LP = Players.LocalPlayer
local Mouse = LP:GetMouse()

-- Settings
local commandPrefix = ";"
local hotkeys = {}
local savedPosition = nil
local spawnWS = LP.Character.Humanoid.WalkSpeed
local spawnJP = LP.Character.Humanoid.JumpPower
local spawnHH = LP.Character.Humanoid.HipHeight

-- Variables
local noclip = false
local flying = false
local doFREECAM = false
local walkto = false
local cmdForward = false
local forwardSpeed = 1
local staring = false
local stopsitting = false
local cbringing = false
local cbringingall = false
local annoying = false
local following = false
local trailing = false
local orbiting = false
local spinning = false
local riding = false
local stutterON = false
local spinTOhead = false
local loopview = false
local savingtoolsloop = false
local spawningfegod = false
local spawningpos = false
local spawningatreset = false
local gliding = false
local glidingSpeed = 3
local ghostmode = false
local noCollideAll = false
local autoClick = false
local autoJump = false
local espEnabled = false
local fullbright = false
local timeStop = false
local rainbowCharacter = false
local xrayVision = false
local antiAfk = false
local autoSprint = false
local noFallDamage = false
local infiniteJump = false
local speedBoost = false
local gravityMod = false
local partHighlight = false
local chatSpy = false
local aimbot = false
local tracers = false
local silentAim = false
local hitboxExpand = false
local autoFarm = false
local autoCollect = false
local autoQuest = false
local autoDance = false
local fakeLag = false
local lagSwitch = false
local antiSlow = false
local antiStun = false
local antiGrab = false
local antiTeleport = false
local antiFreeze = false
local fovChanger = false
local crosshairEnabled = false

-- Command Targets
local walkplr = ""
local stareplr = ""
local CBRINGplr = ""
local CBRINGamount = 3
local annplr = ""
local flwplr = ""
local flwnum = -5
local trlplr = ""
local trlnum = 5
local ridePLAYER = ""
local viewplr = ""
local spinObj = nil
local spawnpos = nil
local spawnresetpoint = LP.Character.Head.CFrame
local glideTarget = nil
local orbitTarget = nil

-- ESP Storage
local espBoxes = {}
local espLabels = {}
local tracersLines = {}

-- GUI Functions
function CreateNotification(title, message, duration, color)
	local Notification = Instance.new("ScreenGui")
	local MainFrame = Instance.new("Frame")
	local Title = Instance.new("TextLabel")
	local MessageLabel = Instance.new("TextLabel")
	local CloseButton = Instance.new("TextButton")
	
	Notification.Name = "FSA_Notification"
	Notification.Parent = CoreGui
	Notification.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
	
	MainFrame.Name = "MainFrame"
	MainFrame.Parent = Notification
	MainFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
	MainFrame.BorderSizePixel = 0
	MainFrame.Position = UDim2.new(1, 10, 0.8, 0)
	MainFrame.Size = UDim2.new(0, 300, 0, 100)
	MainFrame.ZIndex = 100
	
	Title.Name = "Title"
	Title.Parent = MainFrame
	Title.BackgroundColor3 = color or Color3.fromRGB(25, 25, 25)
	Title.BorderSizePixel = 0
	Title.Size = UDim2.new(1, 0, 0, 30)
	Title.Font = Enum.Font.SourceSansBold
	Title.Text = title
	Title.TextColor3 = Color3.fromRGB(255, 255, 255)
	Title.TextSize = 18
	
	MessageLabel.Name = "MessageLabel"
	MessageLabel.Parent = MainFrame
	MessageLabel.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
	MessageLabel.BackgroundTransparency = 1.0
	MessageLabel.Position = UDim2.new(0, 10, 0, 40)
	MessageLabel.Size = UDim2.new(1, -20, 1, -50)
	MessageLabel.Font = Enum.Font.SourceSans
	MessageLabel.Text = message
	MessageLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
	MessageLabel.TextSize = 14
	MessageLabel.TextWrapped = true
	MessageLabel.TextXAlignment = Enum.TextXAlignment.Left
	MessageLabel.TextYAlignment = Enum.TextYAlignment.Top
	
	CloseButton.Name = "CloseButton"
	CloseButton.Parent = MainFrame
	CloseButton.BackgroundColor3 = Color3.fromRGB(255, 50, 50)
	CloseButton.BorderSizePixel = 0
	CloseButton.Position = UDim2.new(1, -25, 0, 5)
	CloseButton.Size = UDim2.new(0, 20, 0, 20)
	CloseButton.Font = Enum.Font.SourceSansBold
	CloseButton.Text = "X"
	CloseButton.TextColor3 = Color3.fromRGB(255, 255, 255)
	CloseButton.TextSize = 14
	
	CloseButton.MouseButton1Click:Connect(function()
		Notification:Destroy()
	end)
	
	MainFrame:TweenPosition(UDim2.new(1, -310, 0.8, 0), "Out", "Quad", 0.5)
	
	if duration then
		task.delay(duration, function()
			if Notification and Notification.Parent then
				Notification:Destroy()
			end
		end)
	end
	
	return Notification
end

function CreateGUI(title, options)
	local GUI = Instance.new("ScreenGui")
	local MainFrame = Instance.new("Frame")
	local TitleBar = Instance.new("Frame")
	local TitleLabel = Instance.new("TextLabel")
	local CloseButton = Instance.new("TextButton")
	local ContentFrame = Instance.new("ScrollingFrame")
	
	GUI.Name = "FSA_GUI_" .. title
	GUI.Parent = CoreGui
	GUI.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
	
	MainFrame.Name = "MainFrame"
	MainFrame.Parent = GUI
	MainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
	MainFrame.BorderSizePixel = 0
	MainFrame.Position = UDim2.new(0.5, -200, 0.5, -150)
	MainFrame.Size = UDim2.new(0, 400, 0, 300)
	MainFrame.ZIndex = 100
	
	TitleBar.Name = "TitleBar"
	TitleBar.Parent = MainFrame
	TitleBar.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
	TitleBar.BorderSizePixel = 0
	TitleBar.Size = UDim2.new(1, 0, 0, 30)
	TitleBar.ZIndex = 101
	
	TitleLabel.Name = "TitleLabel"
	TitleLabel.Parent = TitleBar
	TitleLabel.BackgroundTransparency = 1.0
	TitleLabel.Size = UDim2.new(1, -40, 1, 0)
	TitleLabel.Font = Enum.Font.SourceSansBold
	TitleLabel.Text = title
	TitleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
	TitleLabel.TextSize = 16
	TitleLabel.TextXAlignment = Enum.TextXAlignment.Left
	TitleLabel.TextYAlignment = Enum.TextYAlignment.Center
	
	CloseButton.Name = "CloseButton"
	CloseButton.Parent = TitleBar
	CloseButton.BackgroundColor3 = Color3.fromRGB(255, 50, 50)
	CloseButton.BorderSizePixel = 0
	CloseButton.Position = UDim2.new(1, -30, 0, 5)
	CloseButton.Size = UDim2.new(0, 20, 0, 20)
	CloseButton.Font = Enum.Font.SourceSansBold
	CloseButton.Text = "X"
	CloseButton.TextColor3 = Color3.fromRGB(255, 255, 255)
	CloseButton.TextSize = 14
	CloseButton.ZIndex = 102
	
	CloseButton.MouseButton1Click:Connect(function()
		GUI:Destroy()
	end)
	
	ContentFrame.Name = "ContentFrame"
	ContentFrame.Parent = MainFrame
	ContentFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
	ContentFrame.BorderSizePixel = 0
	ContentFrame.Position = UDim2.new(0, 0, 0, 30)
	ContentFrame.Size = UDim2.new(1, 0, 1, -30)
	ContentFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
	ContentFrame.ScrollBarThickness = 8
	ContentFrame.ZIndex = 100
	
	-- Make draggable
	local dragging = false
	local dragInput, dragStart, startPos
	
	TitleBar.InputBegan:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseButton1 then
			dragging = true
			dragStart = input.Position
			startPos = MainFrame.Position
			input.Changed:Connect(function()
				if input.UserInputState == Enum.UserInputState.End then
					dragging = false
				end
			end)
		end
	end)
	
	TitleBar.InputChanged:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseMovement then
			dragInput = input
		end
	end)
	
	UserInputService.InputChanged:Connect(function(input)
		if input == dragInput and dragging then
			local delta = input.Position - dragStart
			MainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
		end
	end)
	
	return GUI, ContentFrame
end

-- Utility Functions
function view(player)
	if player.Character then
		local humanoid = player.Character:FindFirstChildOfClass("Humanoid")
		if humanoid then
			Workspace.CurrentCamera.CameraSubject = humanoid
		elseif player.Character:FindFirstChild("Head") then
			Workspace.CurrentCamera.CameraSubject = player.Character.Head
		end
	end
end

function FEGodmode()
	if not LP.Character then return end
	
	local changeview = false
	if Workspace.CurrentCamera.CameraSubject == LP.Character.Humanoid or Workspace.CurrentCamera.CameraSubject == LP.Character then
		changeview = true
	end
	
	if LP.Character:FindFirstChildOfClass("Humanoid") then
		LP.Character.Humanoid.Name = "OldHumanoid"
		local l = LP.Character.OldHumanoid:Clone()
		l.Parent = LP.Character
		l.Name = "Humanoid"
		
		task.wait(0.1)
		if LP.Character:FindFirstChild("OldHumanoid") then
			LP.Character.OldHumanoid:Destroy()
		end
		
		if changeview then
			Workspace.CurrentCamera.CameraSubject = LP.Character
		end
		
		if LP.Character:FindFirstChild("Animate") then
			LP.Character.Animate.Disabled = true
			task.wait(0.1)
			LP.Character.Animate.Disabled = false
		end
		
		LP.Character.Humanoid.DisplayDistanceType = "None"
	end
end

function findPlayer(plr)
    local players = {}
    local find = string.lower(plr or "")
    
    if find == "all" then
        for _, v in pairs(Players:GetPlayers()) do
            table.insert(players, v)
        end
    elseif find == "others" then
        for _, v in pairs(Players:GetPlayers()) do
            if v ~= LP then
                table.insert(players, v)
            end
        end
    elseif find == "me" then
        table.insert(players, LP)
    elseif find == "friends" then
        for _, v in pairs(Players:GetPlayers()) do
            if v ~= LP and v:IsFriendsWith(LP.UserId) then
                table.insert(players, v)
            end
        end
    elseif find == "nonfriends" then
        for _, v in pairs(Players:GetPlayers()) do
            if v ~= LP and not v:IsFriendsWith(LP.UserId) then
                table.insert(players, v)
            end
        end
    else
        for _, v in pairs(Players:GetPlayers()) do
            if string.lower(v.Name):find(find, 1, true) or string.lower(v.DisplayName):find(find, 1, true) then
                table.insert(players, v)
            end
        end
    end
    
    return players
end

function findSinglePlayer(plr)
    local players = findPlayer(plr)
    if #players > 0 then
        return {players[1]}
    end
    return {}
end

-- Enhanced ESP System
function CreateESP(player)
	if espEnabled and player ~= LP then
		if not espBoxes[player] then espBoxes[player] = {} end
		if not espLabels[player] then espLabels[player] = {} end
		
		if player.Character then
			for _, part in pairs(player.Character:GetChildren()) do
				if part:IsA("BasePart") and part.Name ~= "HumanoidRootPart" then
					local box = Instance.new("BoxHandleAdornment")
					box.Name = "ESP_" .. player.Name
					box.Adornee = part
					box.AlwaysOnTop = true
					box.ZIndex = 5
					box.Size = part.Size
					box.Transparency = 0.7
					box.Color3 = player.Team and player.TeamColor.Color or Color3.fromRGB(255, 0, 0)
					box.Parent = CoreGui
					
					table.insert(espBoxes[player], box)
				end
			end
			
			-- Name tag
			local billboard = Instance.new("BillboardGui")
			billboard.Name = "ESP_Name_" .. player.Name
			billboard.Adornee = player.Character:FindFirstChild("Head") or player.Character:FindFirstChildOfClass("BasePart")
			billboard.Size = UDim2.new(0, 200, 0, 50)
			billboard.StudsOffset = Vector3.new(0, 3, 0)
			billboard.AlwaysOnTop = true
			billboard.MaxDistance = 1000
			billboard.Parent = CoreGui
			
			local nameLabel = Instance.new("TextLabel")
			nameLabel.Name = "NameLabel"
			nameLabel.BackgroundTransparency = 1
			nameLabel.Size = UDim2.new(1, 0, 0.5, 0)
			nameLabel.Font = Enum.Font.SourceSansBold
			nameLabel.Text = player.Name
			nameLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
			nameLabel.TextStrokeColor3 = Color3.fromRGB(0, 0, 0)
			nameLabel.TextStrokeTransparency = 0.5
			nameLabel.TextSize = 14
			nameLabel.Parent = billboard
			
			local distanceLabel = Instance.new("TextLabel")
			distanceLabel.Name = "DistanceLabel"
			distanceLabel.BackgroundTransparency = 1
			distanceLabel.Position = UDim2.new(0, 0, 0.5, 0)
			distanceLabel.Size = UDim2.new(1, 0, 0.5, 0)
			distanceLabel.Font = Enum.Font.SourceSans
			distanceLabel.Text = "0 studs"
			distanceLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
			distanceLabel.TextStrokeColor3 = Color3.fromRGB(0, 0, 0)
			distanceLabel.TextStrokeTransparency = 0.5
			distanceLabel.TextSize = 12
			distanceLabel.Parent = billboard
			
			table.insert(espLabels[player], billboard)
		end
		
		player.CharacterAdded:Connect(function(character)
			task.wait(1)
			if espEnabled then
				CreateESP(player)
			end
		end)
	end
end

function RemoveESP(player)
	if espBoxes[player] then
		for _, box in pairs(espBoxes[player]) do
			box:Destroy()
		end
		espBoxes[player] = nil
	end
	
	if espLabels[player] then
		for _, label in pairs(espLabels[player]) do
			label:Destroy()
		end
		espLabels[player] = nil
	end
end

function UpdateESPDistances()
	for player, labels in pairs(espLabels) do
		if player.Character and player.Character:FindFirstChild("HumanoidRootPart") and LP.Character and LP.Character:FindFirstChild("HumanoidRootPart") then
			for _, label in pairs(labels) do
				local distanceLabel = label:FindFirstChild("DistanceLabel")
				if distanceLabel then
					local distance = (player.Character.HumanoidRootPart.Position - LP.Character.HumanoidRootPart.Position).Magnitude
					distanceLabel.Text = string.format("%.0f studs", distance)
				end
			end
		end
	end
end

-- Tracers System
function CreateTracer(player)
	if tracers and player ~= LP then
		if not tracersLines[player] then
			local line = Instance.new("Frame")
			line.Name = "Tracer_" .. player.Name
			line.BackgroundColor3 = player.Team and player.TeamColor.Color or Color3.fromRGB(255, 0, 0)
			line.BorderSizePixel = 0
			line.Visible = false
			line.Parent = CoreGui
			tracersLines[player] = line
		end
	end
end

function UpdateTracers()
	for player, line in pairs(tracersLines) do
		if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
			local rootPos = player.Character.HumanoidRootPart.Position
			local screenPos, onScreen = Workspace.CurrentCamera:WorldToViewportPoint(rootPos)
			
			if onScreen then
				line.Visible = true
				line.Size = UDim2.new(0, 2, 0, (Vector2.new(screenPos.X, screenPos.Y) - Vector2.new(Workspace.CurrentCamera.ViewportSize.X / 2, Workspace.CurrentCamera.ViewportSize.Y)).Magnitude)
				line.Position = UDim2.new(0, screenPos.X, 0, screenPos.Y)
				line.Rotation = math.deg(math.atan2(screenPos.Y - Workspace.CurrentCamera.ViewportSize.Y, screenPos.X - Workspace.CurrentCamera.ViewportSize.X / 2)) + 90
			else
				line.Visible = false
			end
		else
			line.Visible = false
		end
	end
end

-- Command Bar
local CommandBar = Instance.new("ScreenGui")
local CMDBAR = Instance.new("Frame")
local CMDBARText = Instance.new("TextBox")

CommandBar.Name = "FSA_CommandBar"
CommandBar.Parent = CoreGui
CommandBar.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

CMDBAR.Name = "CMDBAR"
CMDBAR.Parent = CommandBar
CMDBAR.BackgroundColor3 = Color3.fromRGB(20, 20, 25)
CMDBAR.BackgroundTransparency = 0.3
CMDBAR.BorderSizePixel = 0
CMDBAR.Position = UDim2.new(0.025, 0, 1, 0)
CMDBAR.Size = UDim2.new(0, 350, 0, 40)
CMDBAR.ZIndex = 100

CMDBARText.Name = "CMDBARText"
CMDBARText.Parent = CMDBAR
CMDBARText.BackgroundColor3 = Color3.fromRGB(30, 30, 35)
CMDBARText.BorderSizePixel = 0
CMDBARText.Position = UDim2.new(0.02, 0, 0.15, 0)
CMDBARText.Size = UDim2.new(0.96, 0, 0.7, 0)
CMDBARText.Font = Enum.Font.SourceSansLight
CMDBARText.PlaceholderText = "Type commands here (Prefix: " .. commandPrefix .. ")"
CMDBARText.Text = ""
CMDBARText.TextColor3 = Color3.fromRGB(220, 220, 220)
CMDBARText.TextSize = 16
CMDBARText.TextXAlignment = Enum.TextXAlignment.Left
CMDBARText.ZIndex = 101

UserInputService.InputBegan:Connect(function(input)
	if input.KeyCode == Enum.KeyCode.Semicolon then
		CMDBARText:CaptureFocus()
		CMDBAR:TweenPosition(UDim2.new(0.015, 0, 0.95, 0), "Out", "Elastic", 0.5, true)
	end
end)

CMDBARText.FocusLost:Connect(function(enterPressed)
	CMDBAR:TweenPosition(UDim2.new(0.015, 0, 1, 0), "Out", "Quad", 0.5, true)
	if enterPressed then
		local cmdmsg = CMDBARText.Text
		CMDBARText.Text = ""
		run(commandPrefix .. cmdmsg)
	end
end)

-- Command Execution
function run(msg)
	local cmdPrefix = string.sub(msg, 1, 1)
	if cmdPrefix == commandPrefix then
		msg = string.sub(msg, 2)
		local args = {}
		for arg in string.gmatch(msg, "[^%s]+") do
			table.insert(args, arg)
		end
		local cmdName = args[1]
		table.remove(args, 1)
		
		if Commands[cmdName] then
			Commands[cmdName](args)
		else
			CreateNotification("Error", "Command not found: " .. cmdName, 3, Color3.fromRGB(255, 50, 50))
		end
	end
end

LP.Chatted:Connect(function(chat)
	run(chat)
end)

-- Main Loops
RunService.Stepped:Connect(function()
	-- Noclip
	if noclip and LP.Character then
		for _, part in pairs(LP.Character:GetChildren()) do
			if part:IsA("BasePart") then
				part.CanCollide = false
			end
		end
	end
	
	-- Following/Trailing/Annoying
	if following and flwplr and flwplr.Character and flwplr.Character:FindFirstChild("HumanoidRootPart") then
		LP.Character.HumanoidRootPart.CFrame = flwplr.Character.HumanoidRootPart.CFrame + flwplr.Character.HumanoidRootPart.CFrame.lookVector * flwnum
	end
	
	if trailing and trlplr and trlplr.Character and trlplr.Character:FindFirstChild("HumanoidRootPart") then
		LP.Character.HumanoidRootPart.CFrame = trlplr.Character.HumanoidRootPart.CFrame + trlplr.Character.HumanoidRootPart.CFrame.lookVector * trlnum
	end
	
	if annoying and annplr and annplr.Character and annplr.Character:FindFirstChild("HumanoidRootPart") then
		LP.Character.HumanoidRootPart.CFrame = annplr.Character.HumanoidRootPart.CFrame
	end
	
	-- Walking
	if walkto and walkplr and walkplr.Character and walkplr.Character:FindFirstChild("HumanoidRootPart") then
		LP.Character.Humanoid:MoveTo(walkplr.Character.HumanoidRootPart.Position)
	end
	
	-- Client Bring
	if cbringing and CBRINGplr and CBRINGplr.Character and CBRINGplr.Character:FindFirstChild("HumanoidRootPart") then
		CBRINGplr.Character.HumanoidRootPart.CFrame = LP.Character.HumanoidRootPart.CFrame + LP.Character.HumanoidRootPart.CFrame.lookVector * CBRINGamount
	end
	
	if cbringingall then
		for _, player in pairs(Players:GetPlayers()) do
			if player ~= LP and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
				player.Character.HumanoidRootPart.CFrame = LP.Character.HumanoidRootPart.CFrame + LP.Character.HumanoidRootPart.CFrame.lookVector * CBRINGamount
			end
		end
	end
	
	-- Staring
	if staring and stareplr and stareplr.Character and stareplr.Character:FindFirstChild("HumanoidRootPart") then
		LP.Character.HumanoidRootPart.CFrame = CFrame.new(LP.Character.HumanoidRootPart.Position, stareplr.Character.HumanoidRootPart.Position)
	end
	
	-- Auto-unsit
	if stopsitting and LP.Character.Humanoid then
		LP.Character.Humanoid.Sit = false
	end
	
	-- Loop View
	if loopview and viewplr then
		view(viewplr)
	end
	
	-- Forward
	if cmdForward and LP.Character.HumanoidRootPart then
		LP.Character.HumanoidRootPart.CFrame = LP.Character.HumanoidRootPart.CFrame + LP.Character.HumanoidRootPart.CFrame.lookVector * forwardSpeed
	end
	
	-- Spin Hats
	if spinTOhead and spinObj and LP.Character.Head then
		spinObj.Position = LP.Character.Head.Position
	end
	
	-- Riding
	if riding and ridePLAYER and ridePLAYER.Character and ridePLAYER.Character:FindFirstChild("HumanoidRootPart") then
		LP.Character.HumanoidRootPart.CFrame = ridePLAYER.Character.HumanoidRootPart.CFrame + Vector3.new(0, 3, 0)
	end
	
	-- Stutter
	if stutterON then
		LP.Character.HumanoidRootPart.Anchored = not LP.Character.HumanoidRootPart.Anchored
		task.wait(0.1)
	end
	
	-- Ghost Mode
	if ghostmode and LP.Character then
		for _, part in pairs(LP.Character:GetChildren()) do
			if part:IsA("BasePart") then
				part.CanCollide = false
				part.Transparency = 0.5
			end
		end
	end
	
	-- No Collide All
	if noCollideAll then
		for _, obj in pairs(Workspace:GetChildren()) do
			if obj:IsA("BasePart") then
				obj.CanCollide = false
			end
		end
	end
	
	-- Auto Click
	if autoClick and Mouse.Target then
		mouse1click()
	end
	
	-- Auto Jump
	if autoJump and LP.Character.Humanoid then
		if not LP.Character.Humanoid:GetState() == Enum.HumanoidStateType.Freefall then
			LP.Character.Humanoid.Jump = true
		end
	end
	
	-- Auto Sprint
	if autoSprint and LP.Character.Humanoid then
		LP.Character.Humanoid.WalkSpeed = 32
	end
	
	-- Infinite Jump
	if infiniteJump then
		LP.Character.Humanoid:ChangeState(Enum.HumanoidStateType.Jumping)
	end
	
	-- Speed Boost
	if speedBoost and LP.Character.Humanoid then
		LP.Character.Humanoid.WalkSpeed = 50
	end
	
	-- Gravity Modifier
	if gravityMod then
		Workspace.Gravity = 50
	end
	
	-- ESP Updates
	if espEnabled then
		UpdateESPDistances()
	end
	
	-- Tracers Updates
	if tracers then
		UpdateTracers()
	end
	
	-- Fullbright
	if fullbright then
		Lighting.Ambient = Color3.new(1, 1, 1)
		Lighting.Brightness = 2
		Lighting.GlobalShadows = false
	end
	
	-- Time Stop
	if timeStop then
		Lighting.ClockTime = 12
	end
	
	-- Rainbow Character
	if rainbowCharacter and LP.Character then
		for _, part in pairs(LP.Character:GetChildren()) do
			if part:IsA("BasePart") and part:FindFirstChildOfClass("SpecialMesh") == nil then
				part.Color = Color3.fromHSV(tick() % 5 / 5, 1, 1)
			end
		end
	end
	
	-- XRay Vision
	if xrayVision and LP.Character then
		for _, part in pairs(Workspace:GetChildren()) do
			if part:IsA("BasePart") and part ~= LP.Character:FindFirstChild("HumanoidRootPart") then
				part.LocalTransparencyModifier = 0.5
			end
		end
	end
end)

RunService.RenderStepped:Connect(function()
	-- Anti-AFK
	if antiAfk then
		LP.Idled:Connect(function()
			VirtualInputManager:SendKeyEvent(true, Enum.KeyCode.Space, false, nil)
			task.wait(0.1)
			VirtualInputManager:SendKeyEvent(false, Enum.KeyCode.Space, false, nil)
		end)
	end
	
	-- Crosshair
	if crosshairEnabled then
		if not CoreGui:FindFirstChild("FSA_Crosshair") then
			local crosshair = Instance.new("ScreenGui")
			local frame1 = Instance.new("Frame")
			local frame2 = Instance.new("Frame")
			
			crosshair.Name = "FSA_Crosshair"
			crosshair.Parent = CoreGui
			crosshair.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
			
			frame1.Name = "Horizontal"
			frame1.Parent = crosshair
			frame1.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
			frame1.BorderSizePixel = 0
			frame1.Size = UDim2.new(0, 20, 0, 2)
			frame1.Position = UDim2.new(0.5, -10, 0.5, -1)
			frame1.ZIndex = 1000
			
			frame2.Name = "Vertical"
			frame2.Parent = crosshair
			frame2.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
			frame2.BorderSizePixel = 0
			frame2.Size = UDim2.new(0, 2, 0, 20)
			frame2.Position = UDim2.new(0.5, -1, 0.5, -10)
			frame2.ZIndex = 1000
		end
	else
		local crosshair = CoreGui:FindFirstChild("FSA_Crosshair")
		if crosshair then
			crosshair:Destroy()
		end
	end
end)

-- Character respawn handling
LP.CharacterAdded:Connect(function(character)
	task.wait(0.2)
	local humanoid = character:WaitForChild("Humanoid")
	
	humanoid.WalkSpeed = spawnWS
	humanoid.JumpPower = spawnJP
	humanoid.HipHeight = spawnHH
	
	if spawningfegod then
		FEGodmode()
	end
	
	if spawningpos and spawnpos then
		character:WaitForChild("HumanoidRootPart").CFrame = spawnpos
	end
	
	if spawningatreset then
		character:WaitForChild("HumanoidRootPart").CFrame = spawnresetpoint
	end
	
	-- Re-enable ESP for all players
	if espEnabled then
		for _, player in pairs(Players:GetPlayers()) do
			if player ~= LP then
				CreateESP(player)
			end
		end
	end
end)

LP.CharacterRemoving:Connect(function()
	flying = false
	doFREECAM = false
	
	if savingtoolsloop then
		Commands.savealltool({})
	end
	
	if spawningatreset then
		spawnresetpoint = LP.Character.Head.CFrame + Vector3.new(0, 5, 0)
	end
end)

-- Commands Dictionary
Commands = {}

-- Enhanced Movement Commands
Commands.speed = function(args) Commands.ws(args) end
Commands.ws = function(args)
	if args[1] and LP.Character.Humanoid then
		local speed = tonumber(args[1])
		if speed then
			LP.Character.Humanoid.WalkSpeed = speed
			CreateNotification("Walk Speed", "Set to: " .. speed, 3, Color3.fromRGB(0, 150, 255))
		end
	end
end

Commands.jumppower = function(args) Commands.jp(args) end
Commands.jp = function(args)
	if args[1] and LP.Character.Humanoid then
		local power = tonumber(args[1])
		if power then
			LP.Character.Humanoid.JumpPower = power
			CreateNotification("Jump Power", "Set to: " .. power, 3, Color3.fromRGB(0, 150, 255))
		end
	end
end

Commands.hipheight = function(args) Commands.hh(args) end
Commands.hh = function(args)
	if args[1] and LP.Character.Humanoid then
		local height = tonumber(args[1])
		if height then
			LP.Character.Humanoid.HipHeight = height
			CreateNotification("Hip Height", "Set to: " .. height, 3, Color3.fromRGB(0, 150, 255))
		end
	end
end

Commands.default = function(args)
	if LP.Character.Humanoid then
		LP.Character.Humanoid.WalkSpeed = 16
		LP.Character.Humanoid.JumpPower = 50
		LP.Character.Humanoid.HipHeight = 0
		CreateNotification("Defaults", "Reset to normal values", 3, Color3.fromRGB(0, 200, 0))
	end
end

-- Enhanced Navigation
Commands.goto = function(args)
	if args[1] then
		local target = args[1]
		for _, player in pairs(findPlayer(target)) do
			if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
				local targetPos = player.Character.HumanoidRootPart.CFrame
				LP.Character.HumanoidRootPart.CFrame = targetPos
				CreateNotification("Teleport", "Went to " .. player.Name, 3, Color3.fromRGB(0, 200, 0))
			end
		end
	end
end

Commands.gotopos = function(args) Commands.tppos(args) end
Commands.tppos = function(args)
	if args[1] and args[2] and args[3] then
		local x, y, z = tonumber(args[1]), tonumber(args[2]), tonumber(args[3])
		if x and y and z then
			LP.Character.HumanoidRootPart.CFrame = CFrame.new(x, y, z)
			CreateNotification("Teleport", string.format("Teleported to [%d, %d, %d]", x, y, z), 3, Color3.fromRGB(0, 200, 0))
		end
	end
end

Commands.savepos = function(args)
	savedPosition = LP.Character.HumanoidRootPart.CFrame
	CreateNotification("Position", "Saved current position", 3, Color3.fromRGB(0, 200, 0))
end

Commands.loadpos = function(args)
	if savedPosition then
		LP.Character.HumanoidRootPart.CFrame = savedPosition
		CreateNotification("Position", "Loaded saved position", 3, Color3.fromRGB(0, 200, 0))
	else
		CreateNotification("Error", "No position saved!", 3, Color3.fromRGB(255, 50, 50))
	end
end

Commands.pos = function(args)
	local pos = LP.Character.HumanoidRootPart.Position
	CreateNotification("Position", string.format("X: %.1f\nY: %.1f\nZ: %.1f", pos.X, pos.Y, pos.Z), 5, Color3.fromRGB(0, 150, 255))
end

-- Advanced Movement
Commands.noclip = function(args)
	noclip = not noclip
	CreateNotification("Noclip", noclip and "Enabled" or "Disabled", 3, noclip and Color3.fromRGB(0, 200, 0) or Color3.fromRGB(255, 50, 50))
end

Commands.clip = function(args)
	noclip = false
	CreateNotification("Noclip", "Disabled", 3, Color3.fromRGB(255, 50, 50))
end

Commands.ghost = function(args)
	ghostmode = not ghostmode
	CreateNotification("Ghost Mode", ghostmode and "Enabled" or "Disabled", 3, ghostmode and Color3.fromRGB(0, 200, 0) or Color3.fromRGB(255, 50, 50))
end

Commands.nocollide = function(args)
	noCollideAll = not noCollideAll
	CreateNotification("No Collide", noCollideAll and "Enabled" or "Disabled", 3, noCollideAll and Color3.fromRGB(0, 200, 0) or Color3.fromRGB(255, 50, 50))
end

Commands.autoclick = function(args)
	autoClick = not autoClick
	CreateNotification("Auto Click", autoClick and "Enabled" or "Disabled", 3, autoClick and Color3.fromRGB(0, 200, 0) or Color3.fromRGB(255, 50, 50))
end

Commands.autojump = function(args)
	autoJump = not autoJump
	CreateNotification("Auto Jump", autoJump and "Enabled" or "Disabled", 3, autoJump and Color3.fromRGB(0, 200, 0) or Color3.fromRGB(255, 50, 50))
end

Commands.autosprint = function(args)
	autoSprint = not autoSprint
	CreateNotification("Auto Sprint", autoSprint and "Enabled" or "Disabled", 3, autoSprint and Color3.fromRGB(0, 200, 0) or Color3.fromRGB(255, 50, 50))
end

Commands.infinitejump = function(args)
	infiniteJump = not infiniteJump
	CreateNotification("Infinite Jump", infiniteJump and "Enabled" or "Disabled", 3, infiniteJump and Color3.fromRGB(0, 200, 0) or Color3.fromRGB(255, 50, 50))
end

Commands.speedboost = function(args)
	speedBoost = not speedBoost
	CreateNotification("Speed Boost", speedBoost and "Enabled" or "Disabled", 3, speedBoost and Color3.fromRGB(0, 200, 0) or Color3.fromRGB(255, 50, 50))
end

Commands.lowgravity = function(args)
	gravityMod = not gravityMod
	Workspace.Gravity = gravityMod and 50 or 196.2
	CreateNotification("Low Gravity", gravityMod and "Enabled" or "Disabled", 3, gravityMod and Color3.fromRGB(0, 200, 0) or Color3.fromRGB(255, 50, 50))
end

Commands.nofall = function(args)
	noFallDamage = not noFallDamage
	CreateNotification("No Fall Damage", noFallDamage and "Enabled" or "Disabled", 3, noFallDamage and Color3.fromRGB(0, 200, 0) or Color3.fromRGB(255, 50, 50))
	
	if noFallDamage and LP.Character.Humanoid then
		LP.Character.Humanoid:GetPropertyChangedSignal("Health"):Connect(function()
			if LP.Character.Humanoid:GetState() == Enum.HumanoidStateType.Freefall then
				LP.Character.Humanoid.Health = 100
			end
		end)
	end
end

-- Character Commands
Commands.god = function(args)
	FEGodmode()
	CreateNotification("God Mode", "FE Godmode enabled", 5, Color3.fromRGB(0, 200, 0))
end

Commands.invisible = function(args)
	local Character = LP.Character
	if Character:FindFirstChildOfClass("Humanoid").RigType == Enum.HumanoidRigType.R6 then
		local Clone = Character.HumanoidRootPart:Clone()
		Character.HumanoidRootPart:Destroy()
		Clone.Parent = Character
	else
		local root = Character.LowerTorso:FindFirstChild("Root")
		if root then
			local Clone = root:Clone()
			root:Destroy()
			Clone.Parent = Character.LowerTorso
		end
	end
	CreateNotification("Invisibility", "Enabled", 5, Color3.fromRGB(0, 200, 0))
end

Commands.headless = function(args)
	local l = LP.Character.Humanoid:Clone()
	LP.Character.Humanoid:Destroy()
	task.wait(0.2)
	LP.Character.Head.CanCollide = false
	for _, v in pairs(LP.Character:GetDescendants()) do
		if string.sub(v.Name, 1, 4) == "Neck" then
			v:Destroy()
		end
	end
	task.wait(0.2)
	l.Name = "Humanoid"
	l.Parent = LP.Character
	task.wait(0.1)
	Workspace.CurrentCamera.CameraSubject = LP.Character
	if LP.Character:FindFirstChild("Animate") then
		LP.Character.Animate:Destroy()
	end
	CreateNotification("Headless", "Enabled (use grespawn to reset)", 5, Color3.fromRGB(0, 200, 0))
end

Commands.reset = function(args)
	LP.Character:BreakJoints()
	CreateNotification("Reset", "Character reset", 3, Color3.fromRGB(255, 150, 0))
end

Commands.grespawn = function(args)
	LP.Character.Humanoid.Health = 0
	task.wait(1)
	if LP.Character.Head then
		LP.Character.Head.CFrame = CFrame.new(1000000, 0, 1000000)
	end
	CreateNotification("Respawn", "Graceful respawn initiated", 3, Color3.fromRGB(0, 200, 0))
end

Commands.respawn = function(args)
	local mod = Instance.new('Model', Workspace) 
	mod.Name = 'new ' .. LP.Name
	local hum = Instance.new('Humanoid', mod)
	local ins = Instance.new('Part', mod) 
	ins.Name = 'Torso' 
	ins.CanCollide = false 
	ins.Transparency = 1
	LP.Character = mod
	CreateNotification("Respawn", "Force respawn", 3, Color3.fromRGB(0, 200, 0))
end

-- View Commands
Commands.view = function(args)
	if args[1] then
		for _, player in pairs(findSinglePlayer(args[1])) do
			view(player)
			viewplr = player
			loopview = true
			CreateNotification("View", "Now viewing " .. player.Name, 3, Color3.fromRGB(0, 150, 255))
		end
	end
end

Commands.unview = function(args)
	view(LP)
	loopview = false
	CreateNotification("View", "Stopped viewing", 3, Color3.fromRGB(255, 50, 50))
end

-- Following/Trailing Commands
Commands.follow = function(args)
	if args[1] then
		for _, player in pairs(findSinglePlayer(args[1])) do
			flwplr = player
			flwnum = args[2] and tonumber(args[2]) or -5
			following = true
			CreateNotification("Follow", "Following " .. player.Name, 3, Color3.fromRGB(0, 200, 0))
		end
	end
end

Commands.unfollow = function(args)
	following = false
	CreateNotification("Follow", "Stopped following", 3, Color3.fromRGB(255, 50, 50))
end

Commands.trail = function(args)
	if args[1] then
		for _, player in pairs(findSinglePlayer(args[1])) do
			trlplr = player
			trlnum = args[2] and tonumber(args[2]) or 5
			trailing = true
			CreateNotification("Trail", "Trailing " .. player.Name, 3, Color3.fromRGB(0, 200, 0))
		end
	end
end

Commands.untrail = function(args)
	trailing = false
	CreateNotification("Trail", "Stopped trailing", 3, Color3.fromRGB(255, 50, 50))
end

Commands.annoy = function(args)
	if args[1] then
		for _, player in pairs(findSinglePlayer(args[1])) do
			annplr = player
			annoying = true
			CreateNotification("Annoy", "Annoying " .. player.Name, 3, Color3.fromRGB(0, 200, 0))
		end
	end
end

Commands.unannoy = function(args)
	annoying = false
	CreateNotification("Annoy", "Stopped annoying", 3, Color3.fromRGB(255, 50, 50))
end

Commands.walk = function(args)
	if args[1] then
		for _, player in pairs(findSinglePlayer(args[1])) do
			walkplr = player
			walkto = true
			noclip = true
			CreateNotification("Walk", "Walking to " .. player.Name, 3, Color3.fromRGB(0, 200, 0))
		end
	end
end

Commands.unwalk = function(args)
	walkto = false
	noclip = false
	if LP.Character.Humanoid then
		LP.Character.Humanoid:MoveTo(LP.Character.HumanoidRootPart.Position)
	end
	CreateNotification("Walk", "Stopped walking", 3, Color3.fromRGB(255, 50, 50))
end

Commands.glide = function(args)
	if args[1] then
		for _, player in pairs(findSinglePlayer(args[1])) do
			glideTarget = player
			glidingSpeed = args[2] and tonumber(args[2]) or 3
			gliding = true
			
			spawn(function()
				while gliding and glideTarget and glideTarget.Character and glideTarget.Character:FindFirstChild("HumanoidRootPart") do
					local targetPos = glideTarget.Character.HumanoidRootPart.Position
					local direction = (targetPos - LP.Character.HumanoidRootPart.Position).Unit
					LP.Character.HumanoidRootPart.Velocity = direction * (glidingSpeed * 50)
					task.wait()
				end
			end)
			
			CreateNotification("Glide", "Gliding to " .. player.Name, 3, Color3.fromRGB(0, 200, 0))
		end
	end
end

Commands.unglide = function(args)
	gliding = false
	glideTarget = nil
	CreateNotification("Glide", "Stopped gliding", 3, Color3.fromRGB(255, 50, 50))
end

-- Flight System
Commands.fly = function(args)
	local speed = args[1] and tonumber(args[1]) or 50
	
	if flying then
		flying = false
		LP.Character.Humanoid.PlatformStand = false
		CreateNotification("Fly", "Disabled", 3, Color3.fromRGB(255, 50, 50))
		return
	end
	
	flying = true
	local T = LP.Character.HumanoidRootPart
	local CONTROL = {F = 0, B = 0, L = 0, R = 0}
	local lCONTROL = {F = 0, B = 0, L = 0, R = 0}
	
	local BG = Instance.new('BodyGyro', T)
	local BV = Instance.new('BodyVelocity', T)
	BG.P = 9e4
	BG.maxTorque = Vector3.new(9e9, 9e9, 9e9)
	BG.cframe = T.CFrame
	BV.velocity = Vector3.new(0, 0.1, 0)
	BV.maxForce = Vector3.new(9e9, 9e9, 9e9)
	
	UserInputService.InputBegan:Connect(function(input)
		if not flying then return end
		if input.KeyCode == Enum.KeyCode.W then
			CONTROL.F = speed
		elseif input.KeyCode == Enum.KeyCode.S then
			CONTROL.B = -speed
		elseif input.KeyCode == Enum.KeyCode.A then
			CONTROL.L = -speed
		elseif input.KeyCode == Enum.KeyCode.D then
			CONTROL.R = speed
		end
	end)
	
	UserInputService.InputEnded:Connect(function(input)
		if not flying then return end
		if input.KeyCode == Enum.KeyCode.W then
			CONTROL.F = 0
		elseif input.KeyCode == Enum.KeyCode.S then
			CONTROL.B = 0
		elseif input.KeyCode == Enum.KeyCode.A then
			CONTROL.L = 0
		elseif input.KeyCode == Enum.KeyCode.D then
			CONTROL.R = 0
		end
	end)
	
	spawn(function()
		while flying do
			task.wait()
			LP.Character.Humanoid.PlatformStand = true
			
			if CONTROL.L + CONTROL.R ~= 0 or CONTROL.F + CONTROL.B ~= 0 then
				BV.velocity = ((Workspace.CurrentCamera.CoordinateFrame.lookVector * (CONTROL.F + CONTROL.B)) + 
					((Workspace.CurrentCamera.CoordinateFrame * CFrame.new(CONTROL.L + CONTROL.R, (CONTROL.F + CONTROL.B) * 0.2, 0).p) - 
					Workspace.CurrentCamera.CoordinateFrame.p)) * speed
				lCONTROL = {F = CONTROL.F, B = CONTROL.B, L = CONTROL.L, R = CONTROL.R}
			else
				BV.velocity = Vector3.new(0, 0.1, 0)
			end
			
			BG.cframe = Workspace.CurrentCamera.CoordinateFrame
		end
		
		CONTROL = {F = 0, B = 0, L = 0, R = 0}
		lCONTROL = {F = 0, B = 0, L = 0, R = 0}
		BG:Destroy()
		BV:Destroy()
		LP.Character.Humanoid.PlatformStand = false
	end)
	
	CreateNotification("Fly", "Enabled (Speed: " .. speed .. ")", 3, Color3.fromRGB(0, 200, 0))
end

Commands.unfly = function(args)
	flying = false
	CreateNotification("Fly", "Disabled", 3, Color3.fromRGB(255, 50, 50))
end

-- Freecam System
Commands.freecam = function(args) Commands.fc(args) end
Commands.fc = function(args)
	if doFREECAM then
		Commands.unfc(args)
		return
	end
	
	local speed = args[1] and tonumber(args[1]) or 50
	
	-- Remove existing freecam part
	for _, obj in pairs(Workspace:GetChildren()) do
		if obj.Name == "FSA_FreecamPart" then
			obj:Destroy()
		end
	end
	
	-- Create freecam part
	local CameraPart = Instance.new("Part")
	CameraPart.Name = "FSA_FreecamPart"
	CameraPart.CanCollide = false
	CameraPart.Anchored = true
	CameraPart.Transparency = 1
	CameraPart.Size = Vector3.new(1, 1, 1)
	CameraPart.CFrame = Workspace.CurrentCamera.CFrame
	CameraPart.Parent = Workspace
	
	Workspace.CurrentCamera.CameraSubject = CameraPart
	doFREECAM = true
	
	local CONTROL = {F = 0, B = 0, L = 0, R = 0}
	local lCONTROL = {F = 0, B = 0, L = 0, R = 0}
	
	UserInputService.InputBegan:Connect(function(input)
		if not doFREECAM then return end
		if input.KeyCode == Enum.KeyCode.W then
			CONTROL.F = speed
		elseif input.KeyCode == Enum.KeyCode.S then
			CONTROL.B = -speed
		elseif input.KeyCode == Enum.KeyCode.A then
			CONTROL.L = -speed
		elseif input.KeyCode == Enum.KeyCode.D then
			CONTROL.R = speed
		end
	end)
	
	UserInputService.InputEnded:Connect(function(input)
		if not doFREECAM then return end
		if input.KeyCode == Enum.KeyCode.W then
			CONTROL.F = 0
		elseif input.KeyCode == Enum.KeyCode.S then
			CONTROL.B = 0
		elseif input.KeyCode == Enum.KeyCode.A then
			CONTROL.L = 0
		elseif input.KeyCode == Enum.KeyCode.D then
			CONTROL.R = 0
		end
	end)
	
	spawn(function()
		while doFREECAM do
			task.wait()
			
			if CONTROL.L + CONTROL.R ~= 0 or CONTROL.F + CONTROL.B ~= 0 then
				CameraPart.CFrame = CameraPart.CFrame * CFrame.new(-CONTROL.L + CONTROL.R, 0, -CONTROL.F + CONTROL.B) * speed / 100
				lCONTROL = {F = CONTROL.F, B = CONTROL.B, L = CONTROL.L, R = CONTROL.R}
			end
		end
		
		CONTROL = {F = 0, B = 0, L = 0, R = 0}
		lCONTROL = {F = 0, B = 0, L = 0, R = 0}
	end)
	
	CreateNotification("Freecam", "Enabled (Speed: " .. speed .. ")", 3, Color3.fromRGB(0, 200, 0))
end

Commands.unfreecam = function(args) Commands.unfc(args) end
Commands.unfc = function(args)
	doFREECAM = false
	view(LP)
	
	local freecamPart = Workspace:FindFirstChild("FSA_FreecamPart")
	if freecamPart then
		freecamPart:Destroy()
	end
	
	CreateNotification("Freecam", "Disabled", 3, Color3.fromRGB(255, 50, 50))
end

Commands.gotofc = function(args)
	if Workspace:FindFirstChild("FSA_FreecamPart") then
		LP.Character.HumanoidRootPart.CFrame = Workspace.FSA_FreecamPart.CFrame
		Commands.unfc(args)
		CreateNotification("Freecam", "Teleported to freecam position", 3, Color3.fromRGB(0, 200, 0))
	end
end

Commands.fctp = function(args)
	if args[1] and Workspace:FindFirstChild("FSA_FreecamPart") then
		for _, player in pairs(findPlayer(args[1])) do
			if player.Character and player.Character:FindFirstChild("Head") then
				Workspace.FSA_FreecamPart.CFrame = player.Character.Head.CFrame
				CreateNotification("Freecam", "Teleported to " .. player.Name, 3, Color3.fromRGB(0, 200, 0))
			end
		end
	end
end

-- Sit Commands
Commands.sit = function(args)
	if LP.Character.Humanoid then
		LP.Character.Humanoid.Sit = true
		CreateNotification("Sit", "Sitting", 3, Color3.fromRGB(0, 200, 0))
	end
end

Commands.stopsit = function(args)
	stopsitting = true
	CreateNotification("Auto-Unsit", "Enabled", 3, Color3.fromRGB(0, 200, 0))
end

Commands.gosit = function(args)
	stopsitting = false
	CreateNotification("Auto-Unsit", "Disabled", 3, Color3.fromRGB(255, 50, 50))
end

-- Stare Command
Commands.stare = function(args)
	if args[1] then
		for _, player in pairs(findSinglePlayer(args[1])) do
			stareplr = player
			staring = true
			CreateNotification("Stare", "Staring at " .. player.Name, 3, Color3.fromRGB(0, 200, 0))
		end
	end
end

Commands.unstare = function(args)
	staring = false
	CreateNotification("Stare", "Stopped staring", 3, Color3.fromRGB(255, 50, 50))
end

-- Forward Command
Commands.forward = function(args)
	forwardSpeed = args[1] and tonumber(args[1]) or 1
	cmdForward = true
	CreateNotification("Auto-Forward", "Enabled (Speed: " .. forwardSpeed .. ")", 3, Color3.fromRGB(0, 200, 0))
end

Commands.unforward = function(args)
	cmdForward = false
	CreateNotification("Auto-Forward", "Disabled", 3, Color3.fromRGB(255, 50, 50))
end

-- Stutter Command
Commands.stutter = function(args)
	stutterON = not stutterON
	CreateNotification("Stutter", stutterON and "Enabled" or "Disabled", 3, stutterON and Color3.fromRGB(0, 200, 0) or Color3.fromRGB(255, 50, 50))
end

-- Ride Command
Commands.ride = function(args)
	if args[1] then
		for _, player in pairs(findSinglePlayer(args[1])) do
			local Anim = Instance.new("Animation")
			Anim.AnimationId = "rbxassetid://181525430"
			local track = LP.Character.Humanoid:LoadAnimation(Anim)
			riding = true
			ridePLAYER = player
			track:Play()
			CreateNotification("Ride", "Riding " .. player.Name, 3, Color3.fromRGB(0, 200, 0))
		end
	end
end

Commands.unride = function(args)
	riding = false
	CreateNotification("Ride", "Stopped riding", 3, Color3.fromRGB(255, 50, 50))
end

-- Client Bring
Commands.cbring = function(args)
	if args[1] then
		if args[1]:lower() == "all" or args[1]:lower() == "others" then
			cbringingall = true
			CreateNotification("Client Bring", "Bringing all players", 3, Color3.fromRGB(0, 200, 0))
		else
			for _, player in pairs(findSinglePlayer(args[1])) do
				CBRINGplr = player
				cbringing = true
				CreateNotification("Client Bring", "Bringing " .. player.Name, 3, Color3.fromRGB(0, 200, 0))
			end
		end
		CBRINGamount = args[2] and tonumber(args[2]) or 3
	end
end

Commands.uncbring = function(args)
	cbringing = false
	cbringingall = false
	CreateNotification("Client Bring", "Stopped bringing", 3, Color3.fromRGB(255, 50, 50))
end

-- Client Freeze
Commands.cfreeze = function(args)
	if args[1] then
		for _, player in pairs(findPlayer(args[1])) do
			if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
				player.Character.HumanoidRootPart.Anchored = true
			end
		end
		CreateNotification("Client Freeze", "Players frozen", 3, Color3.fromRGB(0, 200, 0))
	end
end

Commands.uncfreeze = function(args)
	if args[1] then
		for _, player in pairs(findPlayer(args[1])) do
			if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
				player.Character.HumanoidRootPart.Anchored = false
			end
		end
	else
		for _, player in pairs(Players:GetPlayers()) do
			if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
				player.Character.HumanoidRootPart.Anchored = false
			end
		end
	end
	CreateNotification("Client Freeze", "Players unfrozen", 3, Color3.fromRGB(255, 50, 50))
end

-- ESP System
Commands.esp = function(args)
	if args[1] then
		if args[1]:lower() == "all" then
			espEnabled = true
			for _, player in pairs(Players:GetPlayers()) do
				if player ~= LP then
					CreateESP(player)
				end
			end
			CreateNotification("ESP", "Enabled for all players", 3, Color3.fromRGB(0, 200, 0))
		elseif args[1]:lower() == "off" then
			espEnabled = false
			for player, _ in pairs(espBoxes) do
				RemoveESP(player)
			end
			CreateNotification("ESP", "Disabled", 3, Color3.fromRGB(255, 50, 50))
		else
			for _, player in pairs(findPlayer(args[1])) do
				CreateESP(player)
				CreateNotification("ESP", "Enabled for " .. player.Name, 3, Color3.fromRGB(0, 200, 0))
			end
		end
	end
end

Commands.unesp = function(args)
	if args[1] then
		for _, player in pairs(findPlayer(args[1])) do
			RemoveESP(player)
			CreateNotification("ESP", "Disabled for " .. player.Name, 3, Color3.fromRGB(255, 50, 50))
		end
	else
		espEnabled = false
		for player, _ in pairs(espBoxes) do
			RemoveESP(player)
		end
		CreateNotification("ESP", "Disabled for all", 3, Color3.fromRGB(255, 50, 50))
	end
end

-- Tracers System
Commands.tracers = function(args)
	if args[1] then
		if args[1]:lower() == "all" then
			tracers = true
			for _, player in pairs(Players:GetPlayers()) do
				if player ~= LP then
					CreateTracer(player)
				end
			end
			CreateNotification("Tracers", "Enabled for all players", 3, Color3.fromRGB(0, 200, 0))
		elseif args[1]:lower() == "off" then
			tracers = false
			for player, line in pairs(tracersLines) do
				line:Destroy()
			end
			tracersLines = {}
			CreateNotification("Tracers", "Disabled", 3, Color3.fromRGB(255, 50, 50))
		end
	end
end

-- Aimbot System
Commands.aimbot = function(args)
	aimbot = not aimbot
	if aimbot then
		spawn(function()
			while aimbot do
				task.wait()
				local closestPlayer = nil
				local closestDistance = math.huge
				
				for _, player in pairs(Players:GetPlayers()) do
					if player ~= LP and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
						local distance = (player.Character.HumanoidRootPart.Position - LP.Character.HumanoidRootPart.Position).Magnitude
						if distance < closestDistance then
							closestDistance = distance
							closestPlayer = player
						end
					end
				end
				
				if closestPlayer and closestPlayer.Character and closestPlayer.Character:FindFirstChild("HumanoidRootPart") then
					Workspace.CurrentCamera.CFrame = CFrame.new(Workspace.CurrentCamera.CFrame.Position, closestPlayer.Character.HumanoidRootPart.Position)
				end
			end
		end)
	end
	CreateNotification("Aimbot", aimbot and "Enabled" or "Disabled", 3, aimbot and Color3.fromRGB(0, 200, 0) or Color3.fromRGB(255, 50, 50))
end

-- Silent Aim
Commands.silentaim = function(args)
	silentAim = not silentAim
	CreateNotification("Silent Aim", silentAim and "Enabled" or "Disabled", 3, silentAim and Color3.fromRGB(0, 200, 0) or Color3.fromRGB(255, 50, 50))
end

-- Hitbox Expand
Commands.hitbox = function(args)
	hitboxExpand = not hitboxExpand
	if hitboxExpand then
		for _, player in pairs(Players:GetPlayers()) do
			if player ~= LP and player.Character then
				for _, part in pairs(player.Character:GetChildren()) do
					if part:IsA("BasePart") then
						part.Size = part.Size * 2
					end
				end
			end
		end
	else
		for _, player in pairs(Players:GetPlayers()) do
			if player ~= LP and player.Character then
				for _, part in pairs(player.Character:GetChildren()) do
					if part:IsA("BasePart") then
						part.Size = part.Size / 2
					end
				end
			end
		end
	end
	CreateNotification("Hitbox Expand", hitboxExpand and "Enabled" or "Disabled", 3, hitboxExpand and Color3.fromRGB(0, 200, 0) or Color3.fromRGB(255, 50, 50))
end

-- Animation Commands
Commands.animation = function(args)
	if args[1] then
		if args[1]:lower() == "gui" then
			loadstring(game:HttpGet("https://pastebin.com/raw/mdbTSP4d", true))()
		else
			local Anim = Instance.new("Animation")
			Anim.AnimationId = "rbxassetid://" .. args[1]
			local track = LP.Character.Humanoid:LoadAnimation(Anim)
			if args[2] then
				track:Play(.1, 1, tonumber(args[2]))
			else
				track:Play(.1, 1, 1)
			end
			CreateNotification("Animation", "Playing animation ID: " .. args[1], 3, Color3.fromRGB(0, 200, 0))
		end
	end
end

Commands.dance = function(args)
	autoDance = not autoDance
	if autoDance then
		spawn(function()
			local danceAnimations = {
				"rbxassetid://5917459365",
				"rbxassetid://5918726674",
				"rbxassetid://5918864220"
			}
			
			while autoDance do
				local randomAnim = danceAnimations[math.random(1, #danceAnimations)]
				local Anim = Instance.new("Animation")
				Anim.AnimationId = randomAnim
				local track = LP.Character.Humanoid:LoadAnimation(Anim)
				track:Play()
				task.wait(5)
			end
		end)
	end
	CreateNotification("Auto Dance", autoDance and "Enabled" or "Disabled", 3, autoDance and Color3.fromRGB(0, 200, 0) or Color3.fromRGB(255, 50, 50))
end

-- Spawn Settings
Commands.spawn = function(args)
	if args[1] then
		if args[1]:lower() == "ws" then
			spawnWS = args[2] and tonumber(args[2]) or 16
			LP.Character.Humanoid.WalkSpeed = spawnWS
			CreateNotification("Spawn Settings", "Walk speed set to " .. spawnWS, 3, Color3.fromRGB(0, 200, 0))
		elseif args[1]:lower() == "jp" then
			spawnJP = args[2] and tonumber(args[2]) or 50
			LP.Character.Humanoid.JumpPower = spawnJP
			CreateNotification("Spawn Settings", "Jump power set to " .. spawnJP, 3, Color3.fromRGB(0, 200, 0))
		elseif args[1]:lower() == "hh" then
			spawnHH = args[2] and tonumber(args[2]) or 0
			LP.Character.Humanoid.HipHeight = spawnHH
			CreateNotification("Spawn Settings", "Hip height set to " .. spawnHH, 3, Color3.fromRGB(0, 200, 0))
		elseif args[1]:lower() == "god" then
			spawningfegod = true
			FEGodmode()
			CreateNotification("Spawn Settings", "FE Godmode enabled on spawn", 3, Color3.fromRGB(0, 200, 0))
		end
	end
end

Commands.unspawn = function(args)
	spawnWS = 16
	spawnJP = 50
	spawnHH = 0
	spawningfegod = false
	spawningpos = false
	CreateNotification("Spawn Settings", "Reset to defaults", 3, Color3.fromRGB(255, 50, 50))
end

-- Spawn Point
Commands.spawnpoint = function(args)
	spawnpos = LP.Character.HumanoidRootPart.CFrame
	spawningpos = true
	CreateNotification("Spawn Point", "Set current position as spawn point", 3, Color3.fromRGB(0, 200, 0))
end

Commands.nospawn = function(args)
	spawningpos = false
	CreateNotification("Spawn Point", "Removed spawn point", 3, Color3.fromRGB(255, 50, 50))
end

-- Platform Command
Commands.platform = function(args)
	local platform = Instance.new("Part")
	platform.Name = "FSA_Platform"
	platform.Parent = Workspace
	platform.Size = Vector3.new(10, 1, 10)
	platform.Anchored = true
	platform.BrickColor = BrickColor.new("Bright blue")
	platform.Material = Enum.Material.Neon
	platform.CFrame = LP.Character.HumanoidRootPart.CFrame + Vector3.new(0, 5, 0)
	LP.Character.HumanoidRootPart.CFrame = platform.CFrame + Vector3.new(0, 2, 0)
	
	game:GetService("Debris"):AddItem(platform, 20)
	CreateNotification("Platform", "Created for 20 seconds", 3, Color3.fromRGB(0, 200, 0))
end

-- Spin Hats
Commands.spinhats = function(args)
	local power = args[1] and tonumber(args[1]) or 100
	
	for _, v in pairs(LP.Character:GetDescendants()) do
		if v:IsA("Accessory") or v:IsA("Hat") then
			local keep = Instance.new("BodyPosition") 
			keep.Parent = v.Handle 
			keep.Name = "FSA_SpinPos"
			local spin = Instance.new("BodyAngularVelocity") 
			spin.Parent = v.Handle 
			spin.Name = "FSA_SpinVel"
			
			if v.Handle:FindFirstChild("AccessoryWeld") then
				v.Handle.AccessoryWeld:Destroy()
			end
			
			spin.AngularVelocity = Vector3.new(0, power, 0)
			spin.MaxTorque = Vector3.new(0, power * 2, 0)
			
			keep.P = 30000
			keep.D = 50
			spinObj = keep
			spinTOhead = true
		end
	end
	CreateNotification("Spin Hats", "Enabled (Power: " .. power .. ")", 3, Color3.fromRGB(0, 200, 0))
end

Commands.unspinhats = function(args)
	for _, v in pairs(LP.Character:GetDescendants()) do
		if v:IsA("Accessory") or v:IsA("Hat") then
			if v.Handle:FindFirstChild("FSA_SpinVel") then
				v.Handle.FSA_SpinVel:Destroy()
			end
			if v.Handle:FindFirstChild("FSA_SpinPos") then
				v.Handle.FSA_SpinPos:Destroy()
			end
		end
	end
	spinTOhead = false
	CreateNotification("Spin Hats", "Disabled", 3, Color3.fromRGB(255, 50, 50))
end

-- Tool Saving
Commands.savetool = function(args)
	if args[1] then
		for _, tool in pairs(LP.Character:GetDescendants()) do
			if tool:IsA("Tool") and string.lower(tool.Name):find(string.lower(args[1]), 1, true) then
				tool.Parent = LP
				tool.Name = "FSA_Saved_" .. tool.Name
				break
			end
		end
	else
		for _, tool in pairs(LP.Character:GetDescendants()) do
			if tool:IsA("Tool") then
				tool.Parent = LP
				tool.Name = "FSA_Saved_" .. tool.Name
			end
		end
	end
	CreateNotification("Tool Save", "Tools saved", 3, Color3.fromRGB(0, 200, 0))
end

Commands.loadtool = function(args)
	if args[1] then
		for _, tool in pairs(LP:GetChildren()) do
			if tool:IsA("Tool") and string.lower(tool.Name):find("fsa_saved_", 1, true) and 
			   string.lower(tool.Name):find(string.lower(args[1]), 1, true) then
				tool.Parent = LP.Backpack
				tool.Name = string.sub(tool.Name, 10)
				break
			end
		end
	else
		for _, tool in pairs(LP:GetChildren()) do
			if tool:IsA("Tool") and string.lower(tool.Name):find("fsa_saved_", 1, true) then
				tool.Parent = LP.Backpack
				tool.Name = string.sub(tool.Name, 10)
			end
		end
	end
	CreateNotification("Tool Load", "Tools loaded", 3, Color3.fromRGB(0, 200, 0))
end

Commands.savealltool = function(args)
	for _, tool in pairs(LP.Character:GetDescendants()) do
		if tool:IsA("Tool") then
			tool.Parent = LP
			tool.Name = "FSA_Saved_" .. tool.Name
		end
	end
	for _, tool in pairs(LP.Backpack:GetChildren()) do
		if tool:IsA("Tool") then
			tool.Parent = LP
			tool.Name = "FSA_Saved_" .. tool.Name
		end
	end
	CreateNotification("Tool Save", "All tools saved", 3, Color3.fromRGB(0, 200, 0))
end

Commands.loadalltool = function(args)
	for _, tool in pairs(LP:GetChildren()) do
		if tool:IsA("Tool") and string.lower(tool.Name):find("fsa_saved_", 1, true) then
			tool.Parent = LP.Backpack
			tool.Name = string.sub(tool.Name, 10)
		end
	end
	CreateNotification("Tool Load", "All tools loaded", 3, Color3.fromRGB(0, 200, 0))
end

Commands.autosavetool = function(args)
	savingtoolsloop = not savingtoolsloop
	CreateNotification("Auto-Save Tools", savingtoolsloop and "Enabled" or "Disabled", 3, savingtoolsloop and Color3.fromRGB(0, 200, 0) or Color3.fromRGB(255, 50, 50))
end

-- Workspace Commands
Commands.removefog = function(args)
	Lighting.FogEnd = 9999999999999
	CreateNotification("Fog", "Removed", 3, Color3.fromRGB(0, 200, 0))
end

Commands.fullbright = function(args)
	fullbright = not fullbright
	if not fullbright then
		Lighting.Ambient = Color3.new(0.5, 0.5, 0.5)
		Lighting.Brightness = 1
		Lighting.GlobalShadows = true
	end
	CreateNotification("Fullbright", fullbright and "Enabled" or "Disabled", 3, fullbright and Color3.fromRGB(0, 200, 0) or Color3.fromRGB(255, 50, 50))
end

Commands.timestop = function(args)
	timeStop = not timeStop
	CreateNotification("Time Stop", timeStop and "Enabled" or "Disabled", 3, timeStop and Color3.fromRGB(0, 200, 0) or Color3.fromRGB(255, 50, 50))
end

Commands.rainbow = function(args)
	rainbowCharacter = not rainbowCharacter
	CreateNotification("Rainbow Character", rainbowCharacter and "Enabled" or "Disabled", 3, rainbowCharacter and Color3.fromRGB(0, 200, 0) or Color3.fromRGB(255, 50, 50))
end

Commands.xray = function(args)
	xrayVision = not xrayVision
	if not xrayVision then
		for _, part in pairs(Workspace:GetChildren()) do
			if part:IsA("BasePart") then
				part.LocalTransparencyModifier = 0
			end
		end
	end
	CreateNotification("X-Ray Vision", xrayVision and "Enabled" or "Disabled", 3, xrayVision and Color3.fromRGB(0, 200, 0) or Color3.fromRGB(255, 50, 50))
end

Commands.wsvis = function(args)
	if args[1] then
		local transparency = math.clamp(tonumber(args[1]), 0, 1)
		for _, v in pairs(Workspace:GetDescendants()) do
			if v:IsA("BasePart") or v:IsA("Decal") then
				v.Transparency = transparency
			end
		end
		CreateNotification("Workspace Visibility", "Set to " .. transparency, 3, Color3.fromRGB(0, 200, 0))
	end
end

Commands.removeinvis = function(args)
	local count = 0
	for _, v in pairs(Workspace:GetDescendants()) do
		if v:IsA("BasePart") and v.Name ~= "HumanoidRootPart" and v.Transparency == 1 then
			v:Destroy()
			count = count + 1
		end
	end
	CreateNotification("Remove Invisible", "Removed " .. count .. " parts", 3, Color3.fromRGB(0, 200, 0))
end

Commands.gotoobj = function(args)
	if args[1] then
		for _, obj in pairs(Workspace:GetDescendants()) do
			if obj:IsA("BasePart") and string.lower(obj.Name):find(string.lower(args[1]), 1, true) then
				LP.Character.HumanoidRootPart.CFrame = obj.CFrame + Vector3.new(0, 3, 0)
				CreateNotification("Go to Object", "Teleported to " .. obj.Name, 3, Color3.fromRGB(0, 200, 0))
				break
			end
		end
	end
end

Commands.delobj = function(args)
	if args[1] then
		local count = 0
		for _, obj in pairs(Workspace:GetDescendants()) do
			if obj:IsA("BasePart") and string.lower(obj.Name):find(string.lower(args[1]), 1, true) then
				obj:Destroy()
				count = count + 1
			end
		end
		CreateNotification("Delete Object", "Deleted " .. count .. " objects", 3, Color3.fromRGB(0, 200, 0))
	end
end

Commands.bringobj = function(args)
	if args[1] then
		for _, obj in pairs(Workspace:GetDescendants()) do
			if obj:IsA("BasePart") and string.lower(obj.Name):find(string.lower(args[1]), 1, true) then
				local distance = args[2] and tonumber(args[2]) or 3
				obj.CFrame = LP.Character.HumanoidRootPart.CFrame + LP.Character.HumanoidRootPart.CFrame.lookVector * distance
				CreateNotification("Bring Object", "Brought " .. obj.Name, 3, Color3.fromRGB(0, 200, 0))
				break
			end
		end
	end
end

Commands.highlight = function(args)
	partHighlight = not partHighlight
	if partHighlight then
		spawn(function()
			while partHighlight do
				if Mouse.Target then
					if not Mouse.Target:FindFirstChild("FSA_Highlight") then
						local highlight = Instance.new("Highlight")
						highlight.Name = "FSA_Highlight"
						highlight.FillColor = Color3.fromRGB(255, 255, 0)
						highlight.OutlineColor = Color3.fromRGB(255, 200, 0)
						highlight.Parent = Mouse.Target
					end
				end
				task.wait()
			end
		end)
	else
		for _, obj in pairs(Workspace:GetDescendants()) do
			if obj:FindFirstChild("FSA_Highlight") then
				obj.FSA_Highlight:Destroy()
			end
		end
	end
	CreateNotification("Part Highlight", partHighlight and "Enabled" or "Disabled", 3, partHighlight and Color3.fromRGB(0, 200, 0) or Color3.fromRGB(255, 50, 50))
end

-- Btools
Commands.btools = function(args)
	local Clone_T = Instance.new("HopperBin", LP.Backpack)
	Clone_T.BinType = "Clone"
	local Destruct = Instance.new("HopperBin", LP.Backpack)
	Destruct.BinType = "Hammer"
	local Hold_T = Instance.new("HopperBin", LP.Backpack)
	Hold_T.BinType = "Grab"
	CreateNotification("Btools", "Given", 3, Color3.fromRGB(0, 200, 0))
end

-- Camera Commands
Commands.fixcam = function(args)
	Workspace.CurrentCamera.CameraSubject = LP.Character.Humanoid
	Workspace.CurrentCamera.CameraType = "Custom"
	LP.CameraMinZoomDistance = 0.5
	LP.CameraMaxZoomDistance = 400
	LP.CameraMode = "Classic"
	CreateNotification("Camera Fix", "Camera fixed", 3, Color3.fromRGB(0, 200, 0))
end

Commands.breakcam = function(args)
	Workspace.CurrentCamera.CameraSubject = LP.Character.Head
	CreateNotification("Camera Break", "Camera broken", 3, Color3.fromRGB(255, 150, 0))
end

Commands.inviscam = function(args)
	LP.DevCameraOcclusionMode = "Invisicam"
	CreateNotification("Invisicam", "Enabled", 3, Color3.fromRGB(0, 200, 0))
end

Commands.maxzoom = function(args)
	if args[1] then
		LP.CameraMaxZoomDistance = tonumber(args[1])
		CreateNotification("Max Zoom", "Set to " .. args[1], 3, Color3.fromRGB(0, 200, 0))
	end
end

Commands.shiftlockon = function(args)
	LP.DevEnableMouseLock = true
	CreateNotification("Shift Lock", "Enabled", 3, Color3.fromRGB(0, 200, 0))
end

Commands.crosshair = function(args)
	crosshairEnabled = not crosshairEnabled
	CreateNotification("Crosshair", crosshairEnabled and "Enabled" or "Disabled", 3, crosshairEnabled and Color3.fromRGB(0, 200, 0) or Color3.fromRGB(255, 50, 50))
end

Commands.fov = function(args)
	if args[1] then
		local fov = tonumber(args[1])
		if fov then
			Workspace.CurrentCamera.FieldOfView = fov
			fovChanger = true
			CreateNotification("FOV", "Set to " .. fov, 3, Color3.fromRGB(0, 200, 0))
		end
	else
		fovChanger = not fovChanger
		if fovChanger then
			Workspace.CurrentCamera.FieldOfView = 120
		else
			Workspace.CurrentCamera.FieldOfView = 70
		end
		CreateNotification("FOV", fovChanger and "Set to 120" or "Set to 70", 3, fovChanger and Color3.fromRGB(0, 200, 0) or Color3.fromRGB(255, 50, 50))
	end
end

-- Click Commands
local clicktpKEY = ""
local clickdelKEY = ""
local clicktpACTIVE = false
local clickdelACTIVE = false

UserInputService.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.Keyboard then
		if input.KeyCode.Name == clicktpKEY and clicktpACTIVE then 
			if Mouse.Target then 
				LP.Character.HumanoidRootPart.CFrame = CFrame.new(Mouse.Hit.X, Mouse.Hit.Y + 5, Mouse.Hit.Z)
			end 
		end
		if input.KeyCode.Name == clickdelKEY and clickdelACTIVE then 
			if Mouse.Target then 
				Mouse.Target:Destroy()
			end 
		end
	end
end)

Mouse.Button1Down:Connect(function()
	if clicktpACTIVE and clicktpKEY == "" then
		if Mouse.Target then 
			LP.Character.HumanoidRootPart.CFrame = CFrame.new(Mouse.Hit.X, Mouse.Hit.Y + 5, Mouse.Hit.Z)
		end 
	end
	if clickdelACTIVE and clickdelKEY == "" then
		if Mouse.Target then
			Mouse.Target:Destroy()
		end
	end
end)

Commands.clicktp = function(args)
	if args[1] then
		clicktpKEY = string.sub(args[1], 1, 1)
		clicktpACTIVE = true
	else
		clicktpKEY = ""
		clicktpACTIVE = true
	end
	CreateNotification("Click TP", "Enabled", 3, Color3.fromRGB(0, 200, 0))
end

Commands.unclicktp = function(args)
	clicktpACTIVE = false
	CreateNotification("Click TP", "Disabled", 3, Color3.fromRGB(255, 50, 50))
end

Commands.clickdel = function(args)
	if args[1] then
		clickdelKEY = string.sub(args[1], 1, 1)
		clickdelACTIVE = true
	else
		clickdelKEY = ""
		clickdelACTIVE = true
	end
	CreateNotification("Click Delete", "Enabled", 3, Color3.fromRGB(0, 200, 0))
end

Commands.unclickdel = function(args)
	clickdelACTIVE = false
	CreateNotification("Click Delete", "Disabled", 3, Color3.fromRGB(255, 50, 50))
end

Commands.clickesp = function(args)
	local espEnabled = false
	Mouse.Button1Down:Connect(function()
		if Mouse.Target and not espEnabled then
			espEnabled = true
			local part = Mouse.Target
			local highlight = Instance.new("Highlight")
			highlight.Name = "FSA_ClickESP"
			highlight.FillColor = Color3.fromRGB(0, 255, 0)
			highlight.OutlineColor = Color3.fromRGB(0, 200, 0)
			highlight.Parent = part
			CreateNotification("Click ESP", "Added to " .. part.Name, 3, Color3.fromRGB(0, 200, 0))
		end
	end)
end

-- Utility Commands
Commands.print = function(args)
	local msg = table.concat(args, " ")
	print("[FSA] " .. msg)
	CreateNotification("Print", "Printed to console", 3, Color3.fromRGB(0, 150, 255))
end

Commands.warn = function(args)
	local msg = table.concat(args, " ")
	warn("[FSA] " .. msg)
	CreateNotification("Warn", "Warned to console", 3, Color3.fromRGB(255, 150, 0))
end

Commands.chat = function(args)
	local msg = table.concat(args, " ")
	if ReplicatedStorage:FindFirstChild("DefaultChatSystemChatEvents") then
		ReplicatedStorage.DefaultChatSystemChatEvents.SayMessageRequest:FireServer(msg, "All")
	end
	CreateNotification("Chat", "Sent: " .. msg, 3, Color3.fromRGB(0, 200, 0))
end

Commands.chatspy = function(args)
	chatSpy = not chatSpy
	if chatSpy then
		for _, player in pairs(Players:GetPlayers()) do
			player.Chatted:Connect(function(msg)
				print("[CHAT SPY] " .. player.Name .. ": " .. msg)
			end)
		end
		
		Players.PlayerAdded:Connect(function(player)
			player.Chatted:Connect(function(msg)
				print("[CHAT SPY] " .. player.Name .. ": " .. msg)
			end)
		end)
	end
	CreateNotification("Chat Spy", chatSpy and "Enabled" or "Disabled", 3, chatSpy and Color3.fromRGB(0, 200, 0) or Color3.fromRGB(255, 50, 50))
end

Commands.dice = function(args)
	local roll = math.random(1, 6)
	if ReplicatedStorage:FindFirstChild("DefaultChatSystemChatEvents") then
		ReplicatedStorage.DefaultChatSystemChatEvents.SayMessageRequest:FireServer(" Rolled a " .. roll .. "!", "All")
	end
	CreateNotification("Dice", "Rolled: " .. roll, 3, Color3.fromRGB(0, 200, 0))
end

Commands.random = function(args)
	if args[1] and args[2] then
		local min = tonumber(args[1])
		local max = tonumber(args[2])
		if min and max then
			local num = math.random(min, max)
			if ReplicatedStorage:FindFirstChild("DefaultChatSystemChatEvents") then
				ReplicatedStorage.DefaultChatSystemChatEvents.SayMessageRequest:FireServer(
					" Random number between " .. min .. " and " .. max .. ": " .. num, "All")
			end
			CreateNotification("Random", "Result: " .. num, 3, Color3.fromRGB(0, 200, 0))
		end
	end
end

Commands.closegame = function(args)
	game:Shutdown()
end

Commands.rejoin = function(args)
	TeleportService:Teleport(game.PlaceId, LP)
end

Commands.servertime = function(args)
	local time = math.ceil(Workspace.DistributedGameTime)
	CreateNotification("Server Time", time .. " seconds", 5, Color3.fromRGB(0, 150, 255))
end

Commands.ping = function(args)
	local ping = math.floor(game:GetService("Stats").Network.ServerStatsItem["Data Ping"]:GetValue())
	CreateNotification("Ping", ping .. " ms", 3, Color3.fromRGB(0, 150, 255))
end

Commands.gameid = function(args)
	CreateNotification("Game ID", tostring(game.GameId), 5, Color3.fromRGB(0, 150, 255))
end

Commands.fecheck = function(args)
	if Workspace.FilteringEnabled then
		CreateNotification("FE Check", "FilteringEnabled: TRUE", 5, Color3.fromRGB(0, 200, 0))
	else
		CreateNotification("FE Check", "FilteringEnabled: FALSE", 5, Color3.fromRGB(255, 50, 50))
	end
end

Commands.version = function(args)
	CreateNotification("FujiwaraSayo's Admin", "Version 2.0 | Client-Sided", 5, Color3.fromRGB(200, 0, 200))
end

Commands.credits = function(args)
	CreateNotification("Credits", "FujiwaraSayo's Admin\nBased on Shattervast by illremember#3799\nEnhanced with additional features", 10, Color3.fromRGB(200, 0, 200))
end

Commands.prefix = function(args)
	if args[1] then
		commandPrefix = string.sub(args[1], 1, 1)
		CMDBARText.PlaceholderText = "Type commands here (Prefix: " .. commandPrefix .. ")"
		CreateNotification("Prefix", "Changed to: " .. commandPrefix, 3, Color3.fromRGB(0, 200, 0))
	end
end

Commands.clear = function(args)
	for _, gui in pairs(CoreGui:GetChildren()) do
		if string.find(gui.Name, "FSA_") then
			gui:Destroy()
		end
	end
	CreateNotification("Clear", "Cleared all FSA GUIs", 3, Color3.fromRGB(255, 150, 0))
end

Commands.antiafk = function(args)
	antiAfk = not antiAfk
	CreateNotification("Anti-AFK", antiAfk and "Enabled" or "Disabled", 3, antiAfk and Color3.fromRGB(0, 200, 0) or Color3.fromRGB(255, 50, 50))
end

Commands.fakelag = function(args)
	fakeLag = not fakeLag
	if fakeLag then
		spawn(function()
			while fakeLag do
				LP.Character.HumanoidRootPart.Anchored = true
				task.wait(0.5)
				LP.Character.HumanoidRootPart.Anchored = false
				task.wait(0.5)
			end
		end)
	end
	CreateNotification("Fake Lag", fakeLag and "Enabled" or "Disabled", 3, fakeLag and Color3.fromRGB(0, 200, 0) or Color3.fromRGB(255, 50, 50))
end

Commands.lagswitch = function(args)
	lagSwitch = not lagSwitch
	if lagSwitch then
		game:GetService("NetworkClient"):SetOutgoingKBPSLimit(1)
	else
		game:GetService("NetworkClient"):SetOutgoingKBPSLimit(0)
	end
	CreateNotification("Lag Switch", lagSwitch and "Enabled" or "Disabled", 3, lagSwitch and Color3.fromRGB(0, 200, 0) or Color3.fromRGB(255, 50, 50))
end

Commands.antislow = function(args)
	antiSlow = not antiSlow
	CreateNotification("Anti-Slow", antiSlow and "Enabled" or "Disabled", 3, antiSlow and Color3.fromRGB(0, 200, 0) or Color3.fromRGB(255, 50, 50))
end

Commands.antistun = function(args)
	antiStun = not antiStun
	CreateNotification("Anti-Stun", antiStun and "Enabled" or "Disabled", 3, antiStun and Color3.fromRGB(0, 200, 0) or Color3.fromRGB(255, 50, 50))
end

Commands.antigrab = function(args)
	antiGrab = not antiGrab
	CreateNotification("Anti-Grab", antiGrab and "Enabled" or "Disabled", 3, antiGrab and Color3.fromRGB(0, 200, 0) or Color3.fromRGB(255, 50, 50))
end

Commands.antiteleport = function(args)
	antiTeleport = not antiTeleport
	CreateNotification("Anti-Teleport", antiTeleport and "Enabled" or "Disabled", 3, antiTeleport and Color3.fromRGB(0, 200, 0) or Color3.fromRGB(255, 50, 50))
end

Commands.antifreeze = function(args)
	antiFreeze = not antiFreeze
	CreateNotification("Anti-Freeze", antiFreeze and "Enabled" or "Disabled", 3, antiFreeze and Color3.fromRGB(0, 200, 0) or Color3.fromRGB(255, 50, 50))
end

-- Hotkey System
UserInputService.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.Keyboard then
		local key = input.KeyCode.Name
		for _, hotkey in pairs(hotkeys) do
			local cmd, hotkeyKey = hotkey:match("(.+)//(.+)")
			if key == hotkeyKey then
				run(commandPrefix .. cmd)
				break
			end
		end
	end
end)

Commands.hotkey = function(args)
	if args[1] and args[2] then
		local key = args[1]
		table.remove(args, 1)
		local cmd = table.concat(args, " ")
		table.insert(hotkeys, cmd .. "//" .. key)
		CreateNotification("Hotkey", "Added: " .. key .. " -> " .. cmd, 3, Color3.fromRGB(0, 200, 0))
	end
end

Commands.removehotkey = function(args)
	if args[1] then
		for i, hotkey in pairs(hotkeys) do
			local _, hotkeyKey = hotkey:match("(.+)//(.+)")
			if hotkeyKey == args[1] then
				table.remove(hotkeys, i)
				CreateNotification("Hotkey", "Removed: " .. args[1], 3, Color3.fromRGB(255, 50, 50))
				break
			end
		end
	end
end

Commands.removeallhotkey = function(args)
	hotkeys = {}
	CreateNotification("Hotkeys", "All hotkeys removed", 3, Color3.fromRGB(255, 50, 50))
end

Commands.printhotkeys = function(args)
	print("=== FSA HOTKEYS ===")
	for _, hotkey in pairs(hotkeys) do
		print(hotkey)
	end
	print("===================")
	CreateNotification("Hotkeys", "Printed to console", 3, Color3.fromRGB(0, 150, 255))
end

-- Help Command
Commands.help = function(args) Commands.cmds(args) end
Commands.cmds = function(args)
	local commandsList = {
		"=== FUJIWARASAYO'S ADMIN v2.0 ===",
		"Prefix: " .. commandPrefix,
		"",
		"=== MOVEMENT ===",
		commandPrefix .. "ws/speed [num] - Set walk speed",
		commandPrefix .. "jp/jumppower [num] - Set jump power",
		commandPrefix .. "hh/hipheight [num] - Set hip height",
		commandPrefix .. "default - Reset movement",
		commandPrefix .. "noclip - Toggle noclip",
		commandPrefix .. "clip - Disable noclip",
		commandPrefix .. "ghost - Ghost mode",
		commandPrefix .. "nocollide - No collide all",
		commandPrefix .. "autoclick - Auto click",
		commandPrefix .. "autojump - Auto jump",
		commandPrefix .. "autosprint - Auto sprint",
		commandPrefix .. "infinitejump - Infinite jump",
		commandPrefix .. "speedboost - Speed boost",
		commandPrefix .. "lowgravity - Low gravity",
		commandPrefix .. "nofall - No fall damage",
		"",
		"=== NAVIGATION ===",
		commandPrefix .. "goto [player] - Teleport to player",
		commandPrefix .. "tppos [x] [y] [z] - Teleport to coordinates",
		commandPrefix .. "savepos - Save position",
		commandPrefix .. "loadpos - Load saved position",
		commandPrefix .. "pos - Show position",
		commandPrefix .. "fly [speed] - Fly mode",
		commandPrefix .. "unfly - Stop flying",
		commandPrefix .. "freecam/fc [speed] - Freecam mode",
		commandPrefix .. "unfreecam/unfc - Stop freecam",
		commandPrefix .. "gotofc - Teleport to freecam",
		commandPrefix .. "fctp [player] - Freecam to player",
		"",
		"=== FOLLOWING ===",
		commandPrefix .. "follow [player] [distance] - Follow player",
		commandPrefix .. "unfollow - Stop following",
		commandPrefix .. "trail [player] [distance] - Trail player",
		commandPrefix .. "untrail - Stop trailing",
		commandPrefix .. "annoy [player] - Annoy player",
		commandPrefix .. "unannoy - Stop annoying",
		commandPrefix .. "walk [player] - Walk to player",
		commandPrefix .. "unwalk - Stop walking",
		commandPrefix .. "glide [player] [speed] - Glide to player",
		commandPrefix .. "unglide - Stop gliding",
		commandPrefix .. "stare [player] - Stare at player",
		commandPrefix .. "unstare - Stop staring",
		"",
		"=== CHARACTER ===",
		commandPrefix .. "god - FE Godmode",
		commandPrefix .. "invisible - Invisibility",
		commandPrefix .. "headless - Headless mode",
		commandPrefix .. "reset - Reset character",
		commandPrefix .. "grespawn - Graceful respawn",
		commandPrefix .. "respawn - Force respawn",
		commandPrefix .. "sit - Sit down",
		commandPrefix .. "stopsit - Auto-unsit",
		commandPrefix .. "gosit - Allow sitting",
		commandPrefix .. "ride [player] - Ride player",
		commandPrefix .. "unride - Stop riding",
		"",
		"=== VISUAL ===",
		commandPrefix .. "esp [player/all/off] - ESP system",
		commandPrefix .. "unesp [player] - Remove ESP",
		commandPrefix .. "tracers [all/off] - Tracers",
		commandPrefix .. "aimbot - Aimbot",
		commandPrefix .. "silentaim - Silent aim",
		commandPrefix .. "hitbox - Hitbox expand",
		commandPrefix .. "fullbright - Fullbright",
		commandPrefix .. "timestop - Time stop",
		commandPrefix .. "rainbow - Rainbow character",
		commandPrefix .. "xray - X-Ray vision",
		commandPrefix .. "crosshair - Crosshair",
		commandPrefix .. "fov [num] - Change FOV",
		"",
		"=== ANIMATION ===",
		commandPrefix .. "animation [id] [speed] - Play animation",
		commandPrefix .. "dance - Auto dance",
		commandPrefix .. "spinhats [power] - Spin hats",
		commandPrefix .. "unspinhats - Stop spinning hats",
		"",
		"=== CLIENT ACTIONS ===",
		commandPrefix .. "cbring [player/all] [distance] - Client bring",
		commandPrefix .. "uncbring - Stop client bring",
		commandPrefix .. "cfreeze [player] - Client freeze",
		commandPrefix .. "uncfreeze [player] - Client unfreeze",
		commandPrefix .. "forward [speed] - Auto forward",
		commandPrefix .. "unforward - Stop auto forward",
		commandPrefix .. "stutter - Stutter effect",
		"",
		"=== TOOLS ===",
		commandPrefix .. "savetool [name] - Save tool",
		commandPrefix .. "loadtool [name] - Load tool",
		commandPrefix .. "savealltool - Save all tools",
		commandPrefix .. "loadalltool - Load all tools",
		commandPrefix .. "autosavetool - Auto-save tools",
		commandPrefix .. "btools - Give btools",
		"",
		"=== WORKSPACE ===",
		commandPrefix .. "wsvis [0-1] - Workspace transparency",
		commandPrefix .. "removefog - Remove fog",
		commandPrefix .. "removeinvis - Remove invisible parts",
		commandPrefix .. "gotoobj [name] - Go to object",
		commandPrefix .. "delobj [name] - Delete object",
		commandPrefix .. "bringobj [name] [distance] - Bring object",
		commandPrefix .. "highlight - Part highlight",
		commandPrefix .. "platform - Create platform",
		"",
		"=== CAMERA ===",
		commandPrefix .. "view [player] - View player",
		commandPrefix .. "unview - Stop viewing",
		commandPrefix .. "fixcam - Fix camera",
		commandPrefix .. "breakcam - Break camera",
		commandPrefix .. "inviscam - Invisicam",
		commandPrefix .. "maxzoom [num] - Max zoom distance",
		commandPrefix .. "shiftlockon - Enable shift lock",
		"",
		"=== CLICK ===",
		commandPrefix .. "clicktp [key] - Click teleport",
		commandPrefix .. "unclicktp - Disable click TP",
		commandPrefix .. "clickdel [key] - Click delete",
		commandPrefix .. "unclickdel - Disable click delete",
		commandPrefix .. "clickesp - Click ESP",
		"",
		"=== UTILITY ===",
		commandPrefix .. "print [text] - Print to console",
		commandPrefix .. "warn [text] - Warn to console",
		commandPrefix .. "chat [text] - Chat message",
		commandPrefix .. "chatspy - Chat spy",
		commandPrefix .. "dice - Roll dice",
		commandPrefix .. "random [min] [max] - Random number",
		commandPrefix .. "closegame - Close game",
		commandPrefix .. "rejoin - Rejoin game",
		commandPrefix .. "servertime - Server time",
		commandPrefix .. "ping - Show ping",
		commandPrefix .. "gameid - Game ID",
		commandPrefix .. "fecheck - FE check",
		commandPrefix .. "antiafk - Anti-AFK",
		"",
		"=== PROTECTION ===",
		commandPrefix .. "fakelag - Fake lag",
		commandPrefix .. "lagswitch - Lag switch",
		commandPrefix .. "antislow - Anti-slow",
		commandPrefix .. "antistun - Anti-stun",
		commandPrefix .. "antigrab - Anti-grab",
		commandPrefix .. "antiteleport - Anti-teleport",
		commandPrefix .. "antifreeze - Anti-freeze",
		"",
		"=== SYSTEM ===",
		commandPrefix .. "version - Show version",
		commandPrefix .. "credits - Show credits",
		commandPrefix .. "prefix [key] - Change prefix",
		commandPrefix .. "clear - Clear GUIs",
		commandPrefix .. "hotkey [key] [cmd] - Add hotkey",
		commandPrefix .. "removehotkey [key] - Remove hotkey",
		commandPrefix .. "removeallhotkey - Remove all hotkeys",
		commandPrefix .. "printhotkeys - Print hotkeys",
		commandPrefix .. "help/cmds - Show this help",
		"",
		"=============================="
	}
	
	local gui, content = CreateGUI("FSA Commands", {})
	content.CanvasSize = UDim2.new(0, 0, 0, #commandsList * 20)
	
	for i, line in pairs(commandsList) do
		local label = Instance.new("TextLabel")
		label.Name = "Command_" .. i
		label.Parent = content
		label.BackgroundTransparency = 1
		label.Size = UDim2.new(1, -10, 0, 20)
		label.Position = UDim2.new(0, 5, 0, (i-1) * 20)
		label.Font = Enum.Font.SourceSans
		label.Text = line
		label.TextColor3 = Color3.fromRGB(200, 200, 200)
		label.TextSize = 14
		label.TextXAlignment = Enum.TextXAlignment.Left
		label.TextYAlignment = Enum.TextYAlignment.Center
		
		if string.find(line, "===") then
			label.TextColor3 = Color3.fromRGB(255, 100, 100)
			label.Font = Enum.Font.SourceSansBold
		elseif string.find(line, commandPrefix) then
			label.TextColor3 = Color3.fromRGB(100, 200, 255)
		end
	end
end

-- Initialize ESP for existing players
for _, player in pairs(Players:GetPlayers()) do
	if player ~= LP then
		player.CharacterAdded:Connect(function()
			task.wait(1)
			if espEnabled then
				CreateESP(player)
			end
		end)
	end
end

Players.PlayerAdded:Connect(function(player)
	player.CharacterAdded:Connect(function()
		task.wait(1)
		if espEnabled then
			CreateESP(player)
		end
		if tracers then
			CreateTracer(player)
		end
	end)
	
	if tracers then
		CreateTracer(player)
	end
end)

Players.PlayerRemoving:Connect(function(player)
	RemoveESP(player)
	if tracersLines[player] then
		tracersLines[player]:Destroy()
		tracersLines[player] = nil
	end
end)

-- Initial notification
task.wait(1)
CreateNotification("FujiwaraSayo's Admin", "Successfully loaded! Prefix: " .. commandPrefix .. "\nType " .. commandPrefix .. "help for commands", 10, Color3.fromRGB(200, 0, 200))
print("=========================================")
print("   FujiwaraSayo's Admin v2.0 Loaded!")
print("   Prefix: " .. commandPrefix)
print("   Type " .. commandPrefix .. "help for commands")
print("=========================================")
